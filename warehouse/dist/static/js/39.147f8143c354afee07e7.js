webpackJsonp([39],{U7yf:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("bOdI"),i=a.n(r),s=a("gyMJ"),n=a("dciI"),o=a("3PyT"),l={components:{"img-test":a("Wxb1").default},data:function(){var e=this;return{TempDays:null,ID:"",isEdit:!1,myplace:"",Conveyingplace:[],Carrier:"",CarrierList:[],WareHouseID:sessionStorage.getItem("UserWareHouse"),ShelveID:"",ShelveArr:[],Code:"",WaybillType:"",CarrierID:"",ConsignorID:"",ExcuteStatus:101,Place:"",phonenumber:"",ConsignorName:"",EnterCode:"",Summary:"",Files:[],Waybill:{ID:"",Code:"",EnterCode:"",Type:3,OrderID:"",CarrierID:"",ConsignorID:"",ConsigneeID:"",ConsignorPlace:"",Summary:"",WarehouseID:sessionStorage.getItem("UserWareHouse"),ShelveID:"",Phone:"",FreightPayer:null,Contact:"",Supplier:"",TempEnterCode:"",Files:[]},value:"",cityList:[],model1:"",columns7:[{title:"",slot:"indexs",width:30,align:"center"},{title:"操作",slot:"action",width:100,align:"center"},{renderHeader:function(e,t){return e("div",[e("span",{style:{color:"red","vertical-align":"middle","padding-right":"5px","font-size":"20px;"}},"*"),e("span",{},"型号")])},key:"PartNumber",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.Product.PartNumber},on:{"on-change":function(e){a.row.Product.PartNumber=e.target.value,r.Storages[a.index]=a.row}}})}},{title:"品牌",key:"Manufacturer",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.Product.Manufacturer},on:{"on-change":function(e){a.row.Product.Manufacturer=e.target.value,r.Storages[a.index]=a.row}}})}},{title:"批号",key:"DateCode",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.DateCode},on:{"on-change":function(e){a.row.DateCode=e.target.value,r.Storages[a.index]=a.row}}})}},{renderHeader:function(e,t){return e("div",[e("span",{style:{color:"red","vertical-align":"middle","padding-right":"5px","font-size":"20px;"}},"*"),e("span",{},"数量")])},key:"Quantity",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.Quantity},on:{"on-change":function(e){a.row.Quantity=e.target.value,r.Storages[a.index]=a.row},"on-blur":function(e){1==/^\d+(\.\d{0,2})?$/.test(e.target.value)?(a.row.Quantity=e.target.value,r.Storages[a.index]=a.row):(r.$Message.error("只能输入数量,且保留小数点后两位"),e.target.value="",a.row.Quantity="",r.Storages[a.index]=a.row)}}})}},{renderHeader:function(e,t){return e("div",[e("span",{style:{color:"red","vertical-align":"middle","padding-right":"5px","font-size":"20px;"}},"*"),e("span",{},"原产地")])},slot:"Place",maxWidth:180}],Storages:[{SortingID:"",Type:"",StorageID:"",InputID:"",Origin:"",ProductID:"",Product:{PartNumber:"",Manufacturer:"",PackageCase:"",Packing:""},DateCode:"",CreateDate:"",ShelveID:"",WareHouseID:sessionStorage.getItem("UserWareHouse"),Total:"",Quantity:"",Supplier:"",Summary:""}],Storages2:[{SortingID:"",Type:"",StorageID:"",InputID:"",Origin:"",ProductID:"",Product:{PartNumber:"",Manufacturer:"",PackageCase:"",Packing:""},DateCode:"",CreateDate:"",ShelveID:"",WareHouseID:sessionStorage.getItem("UserWareHouse"),Total:"",Quantity:"",Supplier:"",Summary:""}],Summaryarr:[{title:"",slot:"indexs",width:30,align:"center"},{title:"操作",slot:"action",width:100,align:"center"},{renderHeader:function(e,t){return e("div",[e("span",{style:{color:"red","vertical-align":"middle","padding-right":"5px","font-size":"20px;"}},"*"),e("span",{},"描述")])},key:"Summary",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.Summary},on:{"on-change":function(e){a.row.Summary=e.target.value,r.Summarydata[a.index]=a.row}}})}}],Summarydata:[{SortingID:"",Type:"",StorageID:"",InputID:"",Origin:"",ProductID:"",Product:null,DateCode:"",CreateDate:"",ShelveID:"",WareHouseID:sessionStorage.getItem("UserWareHouse"),Total:"",Quantity:"",Supplier:"",Summary:""}],Summarydata2:[{SortingID:"",Type:"",StorageID:"",InputID:"",Origin:"",ProductID:"",Product:null,DateCode:"",CreateDate:"",ShelveID:"",WareHouseID:sessionStorage.getItem("UserWareHouse"),Total:"",Quantity:"",Supplier:"",Summary:""}],Delete:[]}},created:function(){"revise"==this.$route.name&&(this.isEdit=!0,this.ID=this.$route.query.detailID,console.log(this.$route),this.getdetail(this.$route.query.detailID)),this.setnva(),window.PhotoUploaded=this.changed,this.getWayParter(),this.Carriers(),this.GetUsableShelves()},mounted:function(){},methods:{getdetail:function(e){var t=this;Object(n._39)(e).then(function(e){var a="";0==e.ProductStorages.length?t.Storages=t.Storages2:(t.Storages=e.ProductStorages,a=t.Storages[0].ShelveID),0==e.SummaryStorages.length?t.Summarydata=t.Summarydata2:(t.Summarydata=e.SummaryStorages,a=t.Summarydata[0].ShelveID);var r={ID:e.Waybill.ID,Code:e.Waybill.Code,EnterCode:e.Waybill.EnterCode,Type:e.Waybill.Type,OrderID:e.Waybill.OrderID,CarrierID:e.Waybill.CarrierID,ConsignorID:e.Waybill.Consignor.ID,ConsigneeID:e.Waybill.ConsigneeID,ConsignorPlace:e.Waybill.Consignor.Place,Summary:e.Waybill.Summary,WarehouseID:sessionStorage.getItem("UserWareHouse"),ShelveID:a,Phone:e.Waybill.Consignor.Phone,FreightPayer:null,Contact:e.Waybill.Consignor.Contact,Supplier:e.Waybill.Supplier,TempEnterCode:e.Waybill.TempEnterCode,Files:e.Waybill.Files};t.Waybill=r,t.TempDays=e.Waybill.TempDays})},setnva:function(){this.$store.dispatch("setnvadata",[{title:"暂存录入",href:"/Separate/separateenter"}])},handleCreate1:function(e){this.CarrierList.push({ID:e,Name:e})},addrow:function(e){console.log(e);var t={SortingID:"",Type:"",StorageID:"",InputID:"",Origin:"",ProductID:"",Product:{PartNumber:"",Manufacturer:"",PackageCase:"",Packing:""},DateCode:"",CreateDate:"",ShelveID:"",WareHouseID:sessionStorage.getItem("UserWareHouse"),Total:"",Quantity:"",Supplier:"",Summary:""};this.Storages.splice(e+1,0,t)},addSummary:function(e){var t={SortingID:"",Type:"",StorageID:"",InputID:"",Origin:"",ProductID:"",Product:null,DateCode:"",CreateDate:"",ShelveID:"",WareHouseID:sessionStorage.getItem("UserWareHouse"),Total:"",Quantity:"",Supplier:"",Summary:""};this.Summarydata.splice(e+1,0,t)},delrow:function(e,t,a){if("Summary"==t){if(console.log(this.Summarydata.length),this.Summarydata.length>1){if(""!=a.SortingID&&""!=a.StorageID){var r={SortingID:a.SortingID,StorageID:a.StorageID};this.Delete.push(r)}this.Summarydata.splice(e,1)}}else if(this.Storages.length>1){if(""!=a.SortingID&&""!=a.StorageID){r={SortingID:a.SortingID,StorageID:a.StorageID};this.Delete.push(r)}this.Storages.splice(e,1)}},getWayParter:function(){var e=this;Object(s.G)().then(function(t){console.log(t),e.Conveyingplace=t.obj})},Carriers:function(){var e=this;Object(n.f)(this.WareHouseID).then(function(t){e.CarrierList=t})},submitbtn:function(){if(""==this.Waybill.ShelveID)this.$Message.error("请输暂存库位");else{var e=[],t=[],a=this.Waybill.ShelveID;if(this.Summarydata.length>=1)for(var r=0;r<this.Summarydata.length;r++)""!=this.Summarydata[r].Summary&&(this.Summarydata[r].ShelveID=a,e.push(this.Summarydata[r]));if(this.Storages.length>=1)for(r=0;r<this.Storages.length;r++)""!=this.Storages[r].Product.PartNumber&&(this.Storages[r].ShelveID=a,t.push(this.Storages[r]));if(0==t.length&&0==e.length)this.$Message.error("请录入描述信息或者产品信息,产品信息请录入必填项");else if(t.length>0)for(r=0;r<t.length;r++){if(""==t[r].Product.PartNumber||""==t[r].Quantity||""==t[r].Origin){this.$Message.error("型号数量原产地为必填");break}if(r==t.length-1){var i={AdminID:sessionStorage.getItem("userID"),Waybill:this.Waybill,SummaryStorages:e,ProductStorages:t,Delete:this.Delete};this.cgtempstocks(i),console.log(i)}}else{i={AdminID:sessionStorage.getItem("userID"),Waybill:this.Waybill,SummaryStorages:e,ProductStorages:t,Delete:this.Delete};console.log(i),this.cgtempstocks(i)}}},cgtempstocks:function(e){var t=this;Object(n._49)(e).then(function(e){if(console.log(e),1==e.Success)if(t.$Message.success("暂存库录入成功"),1==t.isEdit){var a=t;setTimeout(function(){a.$store.dispatch("setSpearatedrawer",!1)},1e3)}else{var r;t.Waybill={ID:"",Code:"",EnterCode:"",Type:3,OrderID:"",CarrierID:"",ConsignorID:"",ConsigneeID:"",ConsignorPlace:"",Summary:"",WarehouseID:sessionStorage.getItem("UserWareHouse"),ShelveID:"",Phone:"",FreightPayer:null,Contact:"",Supplier:"",TempEnterCode:"",Files:[]},t.Summarydata=[(r={StorageID:"",Type:""},i()(r,"StorageID",""),i()(r,"InputID",""),i()(r,"Origin",""),i()(r,"ProductID",""),i()(r,"Product",null),i()(r,"DateCode",""),i()(r,"CreateDate",""),i()(r,"ShelveID",""),i()(r,"WareHouseID",sessionStorage.getItem("UserWareHouse")),i()(r,"Total",""),i()(r,"Quantity",""),i()(r,"Supplier",""),i()(r,"Summary",""),r)],t.Storages=[{SortingID:"",Type:"",StorageID:"",InputID:"",Origin:"",ProductID:"",Product:{PartNumber:"",Manufacturer:"",PackageCase:"",Packing:""},DateCode:"",CreateDate:"",ShelveID:"",WareHouseID:sessionStorage.getItem("UserWareHouse"),Total:"",Quantity:"",Supplier:"",Summary:""}],t.Delete=[]}else t.$Message.error("保存失败，请检查录入信息是否正确或联系管理员"),t.Delete=[]})},changeimgs:function(e,t){"webaill"==t&&this.Files.push(e)},delimg:function(e){var t=this,a={id:e.ID};Object(n.o)(a).then(function(a){1==a.Success?(t.$Message.success("删除成功"),t.Waybill.Files.splice(t.Files.indexOf(e),1)):t.$Message.error("删除失败")}),console.log(this.Files)},fromphotos:function(){var e={SessionID:"zancun",AdminID:sessionStorage.getItem("userID")};Object(o.c)(e)},SeletUpload:function(e){if("Waybill"==e){var t={SessionID:this.waybillid,AdminID:sessionStorage.getItem("userID")};Object(o.r)(t)}},changed:function(e){this.testfunction(e)},testfunction:function(e){var t=e[0],a={CustomName:t.FileName,ID:t.FileID,Url:t.Url,type:8e3};this.Waybill.Files.push(a)},setphone:function(){if(""!=this.Waybill.Phone){var e=/(^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$)/.test(this.Waybill.Phone);console.log(e),this.disabledphone=e,0==e&&(this.$Message.error("请输入正确的手机号"),this.Waybill.Phone="")}},clear_btn:function(){"revise"==this.$route.name?this.$store.dispatch("setSpearatedrawer",!1):this.cleardata()},GetUsableShelves:function(){var e=this;sessionStorage.getItem("UserWareHouse");Object(n._6)("HK").then(function(t){console.log(t),e.ShelveArr=t.obj})},clackFilesProcess:function(e){var t={Url:e};Object(o.b)(t)},cleardata:function(){var e;this.Waybill={ID:"",Code:"",EnterCode:"",Type:3,OrderID:"",CarrierID:"",ConsignorID:"",ConsigneeID:"",ConsignorPlace:"",Summary:"",WarehouseID:sessionStorage.getItem("UserWareHouse"),ShelveID:"",Phone:"",FreightPayer:null,Contact:"",Supplier:"",TempEnterCode:"",Files:[]},this.Summarydata=[(e={StorageID:"",Type:""},i()(e,"StorageID",""),i()(e,"InputID",""),i()(e,"Origin",""),i()(e,"ProductID",""),i()(e,"Product",null),i()(e,"DateCode",""),i()(e,"CreateDate",""),i()(e,"ShelveID",""),i()(e,"WareHouseID",sessionStorage.getItem("UserWareHouse")),i()(e,"Total",""),i()(e,"Quantity",""),i()(e,"Supplier",""),i()(e,"Summary",""),e)],this.Storages=[{SortingID:"",Type:"",StorageID:"",InputID:"",Origin:"",ProductID:"",Product:{PartNumber:"",Manufacturer:"",PackageCase:"",Packing:""},DateCode:"",CreateDate:"",ShelveID:"",WareHouseID:sessionStorage.getItem("UserWareHouse"),Total:"",Quantity:"",Supplier:"",Summary:""}]}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("p",{staticClass:"detailtitle"},[e._v("基础信息")]),e._v(" "),a("div",{staticClass:"box"},[a("Row",{staticClass:"setpadding"},[a("Col",{attrs:{xs:2,sm:4,md:4,lg:7}},[a("p",[a("label",[e._v("\n              运  单  号：\n              "),a("Input",{staticClass:"inputwidths",attrs:{placeholder:"请输入运单号"},model:{value:e.Waybill.Code,callback:function(t){e.$set(e.Waybill,"Code",t)},expression:"Waybill.Code"}})],1)]),e._v(" "),a("p",{staticClass:"setpadding"},[a("label",[e._v("\n              入  仓  号：\n              "),a("Input",{staticClass:"inputwidths",attrs:{placeholder:"请输入入仓号"},model:{value:e.Waybill.EnterCode,callback:function(t){e.$set(e.Waybill,"EnterCode",t)},expression:"Waybill.EnterCode"}})],1)]),e._v(" "),a("p",{staticClass:"setpadding"},[a("label",[e._v("\n              订  单  号：\n              "),a("Input",{staticClass:"inputwidths",attrs:{placeholder:"请输入订单号"},model:{value:e.Waybill.OrderID,callback:function(t){e.$set(e.Waybill,"OrderID",t)},expression:"Waybill.OrderID"}})],1)]),e._v(" "),a("p",{staticClass:"setpadding",staticStyle:{width:"172%"}},[a("label",[e._v("\n              备        注：\n              "),a("Input",{staticStyle:{width:"87%"},attrs:{type:"textarea",autosize:{maxRows:3,minRows:3},placeholder:"请输入备注信息"},model:{value:e.Waybill.Summary,callback:function(t){e.$set(e.Waybill,"Summary",t)},expression:"Waybill.Summary"}})],1)])]),e._v(" "),a("Col",{attrs:{xs:2,sm:16,md:10,lg:7}},[a("div",[a("label",[e._v("\n              承   运    商：\n            ")]),e._v(" "),a("Select",{staticClass:"inputwidths",attrs:{filterable:""},model:{value:e.Waybill.CarrierID,callback:function(t){e.$set(e.Waybill,"CarrierID",t)},expression:"Waybill.CarrierID"}},e._l(e.CarrierList,function(t,r){return a("Option",{key:r,attrs:{value:t.ID,label:t.Name}},[a("span",[e._v(e._s(t.Name))])])}),1)],1),e._v(" "),a("p",{staticClass:"setpadding"},[a("label",[e._v("\n              发   货    人：\n              "),a("Input",{staticClass:"inputwidths",attrs:{placeholder:"请输入发货人姓名"},model:{value:e.Waybill.Contact,callback:function(t){e.$set(e.Waybill,"Contact",t)},expression:"Waybill.Contact"}})],1)]),e._v(" "),a("p",{staticClass:"setpadding"},[a("label",[e._v("\n              供   货    商：\n              "),a("Input",{staticClass:"inputwidths",attrs:{placeholder:"请输入供货商"},model:{value:e.Waybill.Supplier,callback:function(t){e.$set(e.Waybill,"Supplier",t)},expression:"Waybill.Supplier"}})],1)])]),e._v(" "),a("Col",{attrs:{xs:2,sm:4,md:4,lg:7}},[a("div",[a("label",[e._v("输   送    地：")]),e._v(" "),a("Select",{staticStyle:{width:"200px"},attrs:{filterable:"",clearable:""},model:{value:e.Waybill.ConsignorPlace,callback:function(t){e.$set(e.Waybill,"ConsignorPlace",t)},expression:"Waybill.ConsignorPlace"}},e._l(e.Conveyingplace,function(t){return a("Option",{key:t.ID,attrs:{value:t.CorPlace}},[e._v(e._s(t.Text))])}),1)],1),e._v(" "),a("p",{staticClass:"setpadding"},[a("label",[e._v("\n              发货人电话：\n              "),a("Input",{staticStyle:{width:"200px"},attrs:{type:"tel",placeholder:"请输入发货人电话"},on:{"on-blur":e.setphone},model:{value:e.Waybill.Phone,callback:function(t){e.$set(e.Waybill,"Phone",t)},expression:"Waybill.Phone"}})],1)]),e._v(" "),a("p",{staticClass:"setpadding"},[a("label",[a("em",{staticClass:"bitian"},[e._v("*")]),e._v("暂 存 库 位：\n            ")]),e._v(" "),a("Select",{staticStyle:{width:"200px"},attrs:{filterable:""},model:{value:e.Waybill.ShelveID,callback:function(t){e.$set(e.Waybill,"ShelveID",t)},expression:"Waybill.ShelveID"}},e._l(e.ShelveArr,function(t,r){return a("Option",{key:r,attrs:{value:t.ShelveID,label:t.ShelveID}},[a("span",[e._v(e._s(t.ShelveID))])])}),1)],1),e._v(" "),null!=e.TempDays?a("p",{staticClass:"setpadding"},[a("label",[e._v("\n                暂 存 天 数：\n            ")]),e._v("\n            "+e._s(e.TempDays)+"\n          ")]):e._e()]),e._v(" "),a("Col",{attrs:{xs:2,sm:4,md:4,lg:3}},[a("div",{staticClass:"setupload"},[a("Button",{attrs:{type:"primary",size:"small",icon:"ios-cloud-upload"},on:{click:function(t){return e.SeletUpload("Waybill")}}},[e._v("传照")])],1),e._v(" "),a("div",{staticClass:"setupload",staticStyle:{float:"rigth"}},[a("Button",{attrs:{size:"small",type:"primary",icon:"md-reverse-camera"},on:{click:function(t){return e.fromphotos("Waybill")}}},[e._v("拍照")])],1),e._v(" "),a("ul",{staticStyle:{clear:"both"}},e._l(e.Waybill.Files,function(t){return a("li",[a("p",{staticClass:"Filesbox"},[a("span",{staticClass:"linkurlcolor",on:{click:function(a){return e.clackFilesProcess(t.Url)}}},[e._v(e._s(t.CustomName))]),e._v(" "),a("Icon",{staticClass:"iconstyle",attrs:{type:"md-trash"},on:{click:function(a){return e.delimg(t)}}})],1)])}),0)])],1)],1)]),e._v(" "),a("div",[a("div",{staticStyle:{"padding-top":"10px"}},[e._m(0),e._v(" "),a("div",{staticStyle:{"padding-top":"10px"}},[a("Table",{attrs:{columns:e.Summaryarr,data:e.Summarydata},scopedSlots:e._u([{key:"indexs",fn:function(t){t.row;var a=t.index;return[e._v(e._s(a+1))]}},{key:"action",fn:function(t){var r=t.row,i=t.index;return[a("Icon",{staticStyle:{"margin-right":"5px","font-size":"20px","font-width":"600"},attrs:{type:"ios-add-circle-outline"},on:{click:function(t){return e.addSummary(i)}}}),e._v(" "),a("Icon",{staticStyle:{"font-size":"20px","font-width":"600"},attrs:{type:"ios-trash-outline"},on:{click:function(t){return e.delrow(i,"Summary",r)}}})]}}])})],1)]),e._v(" "),a("div",{staticStyle:{"padding-top":"30px"}},[e._m(1),e._v(" "),a("div",{staticStyle:{"padding-top":"10px"}},[a("Table",{attrs:{columns:e.columns7,data:e.Storages},scopedSlots:e._u([{key:"indexs",fn:function(t){t.row;var a=t.index;return[e._v(e._s(a+1))]}},{key:"action",fn:function(t){var r=t.row,i=t.index;return[a("Icon",{staticStyle:{"margin-right":"5px","font-size":"20px","font-width":"600"},attrs:{type:"ios-add-circle-outline"},on:{click:function(t){return e.addrow(i)}}}),e._v(" "),a("Icon",{staticStyle:{"font-size":"20px","font-width":"600"},attrs:{type:"ios-trash-outline"},on:{click:function(t){return e.delrow(i,"product",r)}}})]}},{key:"Place",fn:function(t){var r=t.row;return t.index,[a("Select",{attrs:{transfer:!0,filterable:"",clearable:""},model:{value:r.Origin,callback:function(t){e.$set(r,"Origin",t)},expression:"row.Origin"}},e._l(e.Conveyingplace,function(t,r){return a("Option",{key:r,attrs:{value:t.CorPlace}},[e._v(e._s(t.Text))])}),1)]}}])}),e._v(" "),a("div",{staticClass:"buttons"},[0==e.isEdit?a("Button",{staticStyle:{"margin-rigth":"5px"},attrs:{type:"primary",size:"large"},on:{click:e.submitbtn}},[e._v("保存")]):a("Button",{staticStyle:{"margin-rigth":"5px"},attrs:{type:"primary",size:"large"},on:{click:e.submitbtn}},[e._v("修改")]),e._v(" "),a("Button",{attrs:{size:"large"},on:{click:e.clear_btn}},[e._v("取消")])],1)],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"detailtitle"},[this._v("描述信息"),t("em",{staticClass:"mastercontent"},[this._v("（ 如果录入描述性信息，则描述必填 ）")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"detailtitle"},[this._v("产品信息"),t("em",{staticClass:"mastercontent"},[this._v("（ 如果有录入型号，则数量与原产地必填 ）")])])}]};var c=a("VU/8")(l,u,!1,function(e){a("zR1m")},"data-v-9f20df16",null);t.default=c.exports},zR1m:function(e,t){}});
//# sourceMappingURL=39.147f8143c354afee07e7.js.map