webpackJsonp([18],{"604n":function(t,e){},"97GW":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("dciI"),i={name:"Sealing",props:["OrderID","Type","EnterCode","hietorgetDetail","WaybillID","ExcuteStatus"],data:function(){return{options3:{disabledDate:function(t){return t&&t.valueOf()<Date.now()-864e5}},itemindex:-1,showinput:!1,changeQuantity:!1,NewQuantity:null,selectdata:[],saleDate:"",Operateddisable:!0,isclickbtn:!0,isSealingclick:!0,enterCode:null,boxingarr:[],houseid:sessionStorage.getItem("UserWareHouse"),AdminID:sessionStorage.getItem("userID"),oldboxcode:"",newboxcode:"",newboxcodeback:null,oldBoxCode2:null,boxcodetype:"1",showEdit:!1,Nameitem:"0",loading:!0,warehouseId:null,waybillinfo:{},NormalData:[],AbnormalData:[],Normalinfo:null,Abnormainfo:null,Normal:[{type:"selection",width:60,align:"center"},{title:"订单号",slot:"orderid",align:"center"},{title:"箱号",slot:"BoxCode",align:"center"},{title:"型号",slot:"PartNumber",align:"center",width:180},{title:"品牌",slot:"Manufacturer",align:"center"},{title:"批号",slot:"DateCode",align:"center"},{title:"原产地",slot:"Origin",align:"center"},{title:"重量(Kg)",slot:"Weight",align:"center"},{title:"体积",slot:"Volume",align:"center"},{title:"应到",slot:"Quantity",align:"center"},{title:"实到",slot:"PickedQuantity",align:"center",width:130},{title:"承运商",slot:"CarrierName",align:"center",width:150},{title:"运单号",slot:"code",align:"center",width:150},{title:"入库时间",slot:"CreateDate",align:"center",width:145}],showsealing:!1,overweight:[]}},created:function(){},computed:{getExcuteStatus:function(){return console.log(this.ExcuteStatus),this.ExcuteStatus}},mounted:function(){if(this.getlistdata(),console.log(this.getExcuteStatus),1==this.Type)this.Normal[7].title="库位",this.Abnormal[7].title="库位";else{this.Normal.push({title:"操作",slot:"Action",align:"center"})}},methods:{setboxsplit:function(t){if(t)return t.split("]")[1]},getlistdata:function(){var t=this;Object(o._29)(this.OrderID).then(function(e){t.loading=!1,t.Normalinfo=e,t.NormalData=e.TinyOrderID_Group})},delItem:function(t){var e=this;this.$Modal.confirm({title:"是否确认删除该分拣？",onOk:function(){var n={StorageID:t.StorageID,PickingID:t.PickingID,AdminID:sessionStorage.getItem("userID")};Object(o.Q)(n).then(function(t){1==t.success?(e.$Message.success("删除成功"),e.loading=!0,e.getlistdata(),e.$emit("hietorgetDetail")):0==t.success&&e.$Message.error(t.data)})},onCancel:function(){}})},changeboxcode:function(t){console.log(t),this.showEdit=!0,this.oldboxcode=t},handleCreate1:function(t){var e=this;if(""!=t&&null!=t)if(null!=this.oldBoxCode2){var n={boxCode:this.oldBoxCode2};Object(o.c)(n).then(function(n){var i={enterCode:e.EnterCode,code:t,date:e.saleDate,adminID:sessionStorage.getItem("userID")};Object(o.d)(i).then(function(t){console.log(t),0==t.success&&400==t.code?(e.$Message.error("箱号已经被选择，请选择其他箱号"),e.newboxcode=null,e.newboxcodeback=null,e.oldBoxCode2=null,e.isclickbtn=!1):(e.newboxcode=e.setboxsplit(t.boxCode),e.newboxcodeback=t.boxCode,e.oldBoxCode2=t.boxCode,e.isclickbtn=!0)})})}else{n={enterCode:this.EnterCode,code:t,date:this.saleDate,adminID:sessionStorage.getItem("userID")};Object(o.d)(n).then(function(t){0==t.success?(e.$Message.error(t.data),e.newboxcode=null,e.newboxcodeback=null,e.isclickbtn=!1):(e.newboxcode=e.setboxsplit(t.boxCode),e.newboxcodeback=t.boxCode,e.oldBoxCode2=t.boxCode,e.isclickbtn=!0)})}},CgBoxesShow:function(){var t=this,e={enterCode:this.EnterCode,date:""};console.log(this.EnterCode),Object(o.h)(e).then(function(e){e.length>0?t.boxingarr=e:t.boxingarr=[]})},visiblechange:function(t){if(1==t){this.showchangebox=!0;var e=new Date,n=e.getFullYear(),o=e.getMonth()+1,i=e.getDate();this.saleDate=n+"/"+o+"/"+i}else this.newboxcode=null,this.oldBoxCode2=null,this.newboxcodeback=null,this.boxcodetype="1"},BoxcodeDeletefun:function(){var t={boxCode:this.newboxcodeback};Object(o.c)(t).then(function(t){console.log(t)})},oldBoxDelete:function(t){var e={boxCode:t};Object(o.c)(e).then(function(t){})},cancel:function(){this.BoxcodeDeletefun(),this.showEdit=!1,this.oldBoxCode2=null,this.newboxcodeback=null},ok_change:function(){var t=this;if(null!=this.newboxcode&&""!=this.newboxcode){if(1==this.isclickbtn&&null!=this.newboxcodeback){var e={date:this.saleDate,adminID:sessionStorage.getItem("userID"),storageID:this.oldboxcode.StorageID,oldBoxCode:this.oldboxcode.BoxCode,newBoxCode:this.newboxcodeback,source:60};Object(o.d)(e).then(function(e){0==e.success?(t.$Message.error(e.data),t.newboxcodeback=null,t.showEdit=!0):(t.$Message.success("修改成功"),t.loading=!0,t.getlistdata(),t.showEdit=!1)})}}else this.$Message.error("请输入箱号")},changeData:function(t){this.saleDate=t,""!=this.newboxcode&&null!=this.newboxcode&&this.handleCreate1(this.newboxcode)},ok_Sealing:function(){var t=this;if(this.selectdata.length<=0)this.$Message.warning({content:"请选择要封箱的订单",duration:3});else{var e=[];this.overweight=[];for(var n=this.selectdata,o=0,i=n.length;o<i;o++)e.push(n[o].TinyOrderID),(n[o].TotalWeight<n[o].TotalAvgWeight-.5*n[o].TotalAvgWeight||n[o].TotalWeight>n[o].TotalAvgWeight+.5*n[o].TotalAvgWeight)&&this.overweight.push(n[o]);var s={AdminID:sessionStorage.getItem("userID"),TinyOrderID:e,WaybillID:this.WaybillID};console.log(this.overweight),this.overweight.length>0?this.showsealing=!0:(this.showsealing=!1,this.$Modal.confirm({title:"是否确认封箱",onOk:function(){t.isSealingclick=!1,t.cgCustomsStorageCloseBoxes(s)},onCancel:function(){}}))}},ok_sealing:function(){this.isSealingclick=!1;for(var t=[],e=this.selectdata,n=0,o=e.length;n<o;n++)t.push(e[n].TinyOrderID);var i={AdminID:sessionStorage.getItem("userID"),TinyOrderID:t,WaybillID:this.WaybillID};console.log(i),this.cgCustomsStorageCloseBoxes(i)},cancel_sealing:function(){this.showsealing=!1},cgCustomsStorageCloseBoxes:function(t){var e=this;Object(o._33)(t).then(function(t){1==t.success?(e.loading=!0,e.getlistdata(),e.$Message.success("封箱成功"),e.selectdata=[]):e.$Message.error({content:t.data,duration:3}),e.isSealingclick=!0})},selectionchange:function(t){this.selectdata=t,console.log(this.selectdata.length)},changeQuantityBtn:function(t){this.itemindex=t,this.showinput=!0},ok_changeQty:function(t){if(console.log(t),""!=t.SdQty&&null!=t.SdQty){this.loading=!0;var e=sessionStorage.getItem("userID"),n={StorageID:t.StorageID,AdminID:e,Quantity:t.SdQty};this.chengeModify(n)}else this.$Message.warning({content:"请输入要修改的数量",duration:3})},chengeModify:function(t){var e=this;Object(o._16)(t).then(function(t){console.log(t),1==t.Success?(e.itemindex=-1,e.showinput=!1,e.getlistdata()):e.$Message.error({content:t.Data,duration:3})})}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{id:"tablebox"}},[n("Table",{attrs:{columns:t.Normal,data:t.NormalData,border:t.NormalData.length>0,loading:t.loading},on:{"on-selection-change":t.selectionchange},scopedSlots:t._u([{key:"orderid",fn:function(e){var o=e.row;return e.index,[n("span",[t._v(t._s(o.TinyOrderID))])]}},{key:"BoxCode",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v("\n                    "+t._s(t._f("showboxcode")(e.BoxCode))+"\n                     "),1==o.IsAbleDeclare?n("Icon",{staticClass:"changeboxcodeicon",attrs:{type:"md-create"},on:{click:function(n){return t.changeboxcode(e)}}}):t._e()],1)}),0)]}},{key:"PartNumber",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.Product.PartNumber)+"\n                      "),null!=e.Condition?n("span",[1==e.Conditions.IsCIQ?n("Tag",{attrs:{color:"primary"}},[t._v("商检")]):t._e(),t._v(" "),1==e.Conditions.IsCCC?n("Tag",{attrs:{color:"warning"}},[t._v("CCC")]):t._e(),t._v(" "),1==e.Conditions.IsEmbargo?n("Tag",{attrs:{color:"error"}},[t._v("禁运")]):t._e(),t._v(" "),1==e.Conditions.IsHighPrice?n("Tag",{attrs:{color:"magenta"}},[t._v("高价值")]):t._e()],1):t._e()])}),0)]}},{key:"Manufacturer",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.Product.Manufacturer))])}),0)]}},{key:"DateCode",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.DateCode))])}),0)]}},{key:"Origin",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.Origin))])}),0)]}},{key:"Weight",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.Weight))])}),0)]}},{key:"Volume",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.Volume))])}),0)]}},{key:"Quantity",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.YdQty))])}),0)]}},{key:"PickedQuantity",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e,o){return n("li",[t.itemindex==o&&1==t.showinput?n("Input",{staticStyle:{width:"70%"},attrs:{type:"number"},on:{"on-blur":function(n){return t.ok_changeQty(e)},"on-enter":function(n){return t.ok_changeQty(e)}},model:{value:e.SdQty,callback:function(n){t.$set(e,"SdQty",n)},expression:"item.SdQty"}}):n("p",[n("span",[t._v(t._s(e.SdQty))])])],1)}),0)]}},{key:"CreateDate",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(t._f("showDateexact")(e.EnterDate)))])}),0)]}},{key:"CarrierName",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.CarrierName))])}),0)]}},{key:"code",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[t._v(t._s(e.wbCode))])}),0)]}},{key:"Action",fn:function(e){var o=e.row;return e.index,[n("ul",{staticClass:"subCol"},t._l(o.Groups,function(e){return n("li",[n("Button",{attrs:{type:"error",size:"small",disabled:0==e.Display},on:{click:function(n){return t.delItem(e)}}},[t._v("删除")])],1)}),0)]}}])}),t._v(" "),t.NormalData.length>0?n("p",{staticClass:"Statisticsbox"},[n("span",{staticClass:"Statisticspan"},[t._v("合计：")]),t._v(" "),n("span",{staticClass:"Statisticspan"},[t._v("总重量(Kg)："+t._s(t.Normalinfo.TotalWeight))]),t._v(" "),n("span",{staticClass:"Statisticspan"},[t._v("总件数："+t._s(t.Normalinfo.TotalPart))]),t._v(" "),n("span",{staticClass:"Statisticspan"},[t._v("总数量："+t._s(t.Normalinfo.TotalQuantity))]),t._v(" "),n("Button",{attrs:{type:"primary",icon:"md-checkmark",disabled:0!=t.Normalinfo.IsDisabledDeclareBtn},on:{click:t.ok_Sealing}},[t._v("确认封箱")])],1):t._e()],1),t._v(" "),n("Modal",{attrs:{title:"修改箱号","mask-closable":!1},on:{"on-visible-change":t.visiblechange},model:{value:t.showEdit,callback:function(e){t.showEdit=e},expression:"showEdit"}},[n("span",{attrs:{slot:"close"},slot:"close"},[n("Icon",{attrs:{type:"ios-close"},on:{click:t.cancel}})],1),t._v(" "),n("p",{staticStyle:{"padding-top":"10px"}},[n("label",[n("em",{staticClass:"Mustfill"},[t._v("*")]),t._v("日期：\n      ")]),t._v(" "),n("DatePicker",{staticStyle:{width:"80%"},attrs:{type:"date",options:t.options3,placeholder:"请选择生成箱号的时间",clearable:!1,value:t.saleDate},on:{"on-change":t.changeData}})],1),t._v(" "),n("p",{staticStyle:{"padding-top":"10px"}},[n("label",[n("em",{staticClass:"Mustfill"},[t._v("*")]),t._v("箱号：\n    ")]),t._v(" "),n("Input",{staticStyle:{width:"80%"},attrs:{maxlength:"30",placeholder:"请输入临时箱号"},on:{"on-blur":function(e){return t.handleCreate1(t.newboxcode)}},model:{value:t.newboxcode,callback:function(e){t.newboxcode="string"==typeof e?e.trim():e},expression:"newboxcode"}})],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:t.cancel}},[t._v("取消")]),t._v(" "),n("Button",{attrs:{type:"primary"},on:{click:t.ok_change}},[t._v("确定")])],1)]),t._v(" "),n("Modal",{attrs:{title:"修改到货数量","mask-closable":!1},model:{value:t.changeQuantity,callback:function(e){t.changeQuantity=e},expression:"changeQuantity"}},[n("div",[n("label",{attrs:{for:""}},[t._v("数量:")]),t._v(" "),n("Input",{attrs:{placeholder:"请输入数量"},model:{value:t.NewQuantity,callback:function(e){t.NewQuantity=e},expression:"NewQuantity"}})],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",[t._v("取消")]),t._v(" "),n("Button",{attrs:{type:"primary"}},[t._v("确认")])],1)]),t._v(" "),n("Modal",{on:{"on-ok":t.ok_sealing,"on-cancel":t.cancel_sealing},model:{value:t.showsealing,callback:function(e){t.showsealing=e},expression:"showsealing"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("Icon",{staticStyle:{"font-size":"28px",color:"#f90"},attrs:{type:"md-help-circle"}}),t._v(" "),n("span",{staticStyle:{"font-size":"15px","line-height":"26px","vertical-align":"bottom",color:"#0c0c0c","font-weight":"bold"}},[t._v("以下订单不符合重量浮动规则，是否确认封箱")])],1),t._v(" "),t._l(t.overweight,function(e){return n("p",[t._v(t._s(e.TinyOrderID)+" \n        "),n("span",{staticStyle:{"padding-right":"5px"}},[t._v("总重量："+t._s(e.TotalWeight))]),t._v(" "),n("span",{staticStyle:{"padding-right":"5px"}},[t._v("平均重量："+t._s(e.TotalAvgWeight))])])})],2)],1)},staticRenderFns:[]};var a=n("VU/8")(i,s,!1,function(t){n("mgFL"),n("604n")},"data-v-668c0c42",null);e.default=a.exports},mgFL:function(t,e){}});
//# sourceMappingURL=18.137d206a37cb14389711.js.map