<html>
<head>
    <script>var model = {};</script>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>
        在线预览
    </title>
    <style>
        html, body { width: 100%; height: 100%; }
        * { padding: 0px; margin: 0px; list-style: none; }
    </style>

    <script>
        function getAbsoluteUrl(url) {
            var a = document.createElement('a');
            a.href = url;
            url = a.href;
            return url;
        }
        function getArgs(strParame) {
            var args = new Object();
            var query = location.search.substring(1); // Get query string
            var pairs = query.split("&"); // Break at ampersand
            for (var i = 0; i < pairs.length; i++) {
                var pos = pairs[i].indexOf('='); // Look for "name=value"
                if (pos == -1) continue; // If not found, skip
                var argname = pairs[i].substring(0, pos); // Extract the name
                var value = pairs[i].substring(pos + 1); // Extract the value
                value = decodeURIComponent(value); // Decode it, if needed
                args[argname] = value; // Store as a property
            }
            return args[strParame]; // Return the object
        }

        window.onload = function () {
            var src = getArgs('src');
            var ifm = document.getElementById('ifm');

            var names = decodeURIComponent(src).split('/');
            var filename = names[names.length - 1].split('.')[0];

            document.title = '预览：' + filename;

            ifm.src = 'https://view.officeapps.live.com/op/view.aspx?src=' + getAbsoluteUrl(src);
        };
    </script>

</head>
<body>
    <iframe id="ifm" src="" style="width:100% ;height:100%"></iframe>

</body>
</html>