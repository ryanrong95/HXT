webpackJsonp([10,44],{"0Uva":function(e,t){},"7VM5":function(e,t){},"83/3":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("oPnf"),n=a("gyMJ"),o=a("dciI"),i=(a("PJh5"),{components:{Details:r.default},data:function(){return{CarrierList:[],loading:!0,timer1:"",warehouseID:sessionStorage.getItem("UserWareHouse"),total:0,PageIndex:1,value:"",titles:[{title:"#",slot:"indexs",align:"center",width:50},{title:"运单号",slot:"Code"},{title:"到货方式",slot:"OrderID"},{title:"承运商",kslotey:"CarrierName"},{title:"暂存录入时间",slot:"CreateDate"},{title:"入仓号",slot:"EnterCode"},{title:"描述",key:"Summary"},{title:"操作",slot:"action",width:150,align:"center"}],listdata:[],searchdata:{WhID:sessionStorage.getItem("UserWareHouse"),Code:"",CarrierID:"",ShelveID:"",StartTime:"",EndTime:"",PageIndex:"1",PageSize:"10"}}},computed:{Spearatedrawer:{get:function(){return this.$store.state.common.Spearatedrawer},set:function(e){}}},mounted:function(){this.setnva(),this.Carriers(),this.cgtempstockshow()},methods:{setnva:function(){this.$store.dispatch("setnvadata",[{title:"已有暂存",href:"/Stock/Separate"}])},cgtempstockshow:function(){var e=this;Object(o.F)(this.warehouseID,1,10).then(function(t){console.log(t),e.total=t.obj.Total,e.listdata=t.obj.Data,e.loading=!1})},changeDatePicker:function(e){console.log(e),this.searchdata.sStartTime=e[0],this.searchdata.EndTime=e[1]},clearsearch:function(){this.loading=!0,this.SparateWaybill(this.searchdata)},uploadlist:function(e){console.log(e),0==e&&(this.$store.dispatch("setSpearatedrawer",!1),this.$router.go(-1),this.SparateWaybill(this.searchdata))},show:function(e){this.$store.dispatch("setSpearatedrawer",!0),this.$router.push({path:"/Separate/list/revise",query:{detailID:e}})},changepage:function(e){this.loading=!0,this.searchdata.PageIndex=e,this.SparateWaybill(this.searchdata)},SparateWaybill:function(e){var t=this;Object(o.z)(e).then(function(e){t.total=e.obj.Total,t.listdata=e.obj.Data,t.loading=!1})},Carriers:function(){var e=this;Object(n.d)().then(function(t){e.CarrierList=t.obj})},search_btn:function(){this.loading=!0,this.SparateWaybill(this.searchdata)},clear_btn:function(){this.searchdata={WhID:sessionStorage.getItem("UserWareHouse"),Code:"",CarrierID:"",ShelveID:"",StartTime:"",EndTime:"",PageIndex:"1",PageSize:"10"},this.loading=!0,this.$refs.element.handleClear(),this.SparateWaybill(this.searchdata)},changedata:function(e){this.searchdata.createDate=e}}}),s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("label",{attrs:{for:"运单号"}},[e._v("运单号：")]),e._v(" "),a("Input",{staticClass:"setinputs",attrs:{placeholder:"运单号",clearable:""},on:{"on-clear":e.clearsearch},model:{value:e.searchdata.Code,callback:function(t){e.$set(e.searchdata,"Code","string"==typeof t?t.trim():t)},expression:"searchdata.Code"}}),e._v(" "),a("label",{attrs:{for:"运单号"}},[e._v("承运商：")]),e._v(" "),a("Select",{staticClass:"setinputs",attrs:{placeholder:""},model:{value:e.searchdata.CarrierID,callback:function(t){e.$set(e.searchdata,"CarrierID",t)},expression:"searchdata.CarrierID"}},e._l(e.CarrierList,function(t){return a("Option",{key:t.ID,attrs:{value:t.ID}},[e._v(e._s(t.Name))])}),1),e._v(" "),a("label",{attrs:{for:"库位"}},[e._v("库位：")]),e._v(" "),a("Input",{staticClass:"setinputs",attrs:{placeholder:"库位",clearable:""},on:{"on-clear":e.clearsearch},model:{value:e.searchdata.ShelveID,callback:function(t){e.$set(e.searchdata,"ShelveID","string"==typeof t?t.trim():t)},expression:"searchdata.ShelveID"}}),e._v(" "),a("label",{attrs:{for:"暂存录入时间："}},[e._v("暂存录入时间：")]),e._v(" "),a("DatePicker",{ref:"element",staticClass:"setinputs",attrs:{type:"daterange","split-panels":"",placeholder:"请选择一个时间段"},on:{"on-change":e.changeDatePicker,"on-clear":e.clearsearch}}),e._v(" "),a("Button",{attrs:{type:"primary"},on:{click:e.search_btn}},[e._v("查询")]),e._v(" "),a("Button",{attrs:{type:"error"},on:{click:e.clear_btn}},[e._v("清空")])],1),e._v(" "),a("p",[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.show("454545454")}}},[e._v("修改")])],1),e._v(" "),a("div",{staticStyle:{"padding-top":"40px"}},[a("Table",{attrs:{columns:e.titles,data:e.listdata,loading:e.loading},scopedSlots:e._u([{key:"indexs",fn:function(t){t.row;var r=t.index;return[a("strong",[e._v(e._s(r+1))])]}},{key:"Code",fn:function(t){var r=t.row;return t.index,[a("p",[e._v(e._s(r.Waybill.Code))])]}},{key:"OrderID",fn:function(t){var r=t.row;return t.index,[a("p",[e._v(e._s(r.Waybill.OrderID))])]}},{key:"CarrierName",fn:function(t){var r=t.row;return t.index,[a("p",[e._v(e._s(r.Waybill.CarrierName))])]}},{key:"EnterCode",fn:function(t){var r=t.row;return t.index,[a("p",[e._v(e._s(r.Waybill.EnterCode))])]}},{key:"CreateDate",fn:function(t){var r=t.row;return t.index,[a("span",[e._v(e._s(e._f("showDate")(r.Waybill.CreateDate)))])]}},{key:"action",fn:function(t){var r=t.row;return t.index,[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.show(r.Waybill.ID)}}},[e._v("修改")])]}}])}),e._v(" "),a("div",{staticClass:"pagebox"},[a("Page",{attrs:{total:e.total,"page-size":10,current:e.searchdata.pageindex},on:{"on-change":e.changepage}})],1)],1),e._v(" "),a("Drawer",{attrs:{title:"",width:"90"},on:{"on-visible-change":e.uploadlist},model:{value:e.Spearatedrawer,callback:function(t){e.Spearatedrawer=t},expression:"Spearatedrawer"}},[a("router-view")],1)],1)},staticRenderFns:[]};var l=a("VU/8")(i,s,!1,function(e){a("7VM5")},null,null);t.default=l.exports},oPnf:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mvHQ"),n=a.n(r),o=a("gyMJ"),i=a("3PyT"),s={components:{"img-test":a("Wxb1").default},data:function(){var e=this;return{waybillid:"",Consignorid:"",myplace:"",Conveyingplace:[],Carrier:"",CarrierList:[],WareHouseID:sessionStorage.getItem("UserWareHouse"),ShelveID:"",ShelveArr:[],Code:"",WaybillType:"",CarrierID:"",ConsignorID:"",ExcuteStatus:101,Place:"",phonenumber:"",ConsignorName:"",EnterCode:"",Summary:"",Files:[],value:"",cityList:[{value:"New York",label:"New York"},{value:"London",label:"London"},{value:"Sydney",label:"Sydney"},{value:"Ottawa",label:"Ottawa"},{value:"Paris",label:"Paris"},{value:"Canberra",label:"Canberra"}],model1:"",columns7:[{title:"",slot:"indexs",width:30,align:"center"},{title:"操作",slot:"action",width:100,align:"center"},{title:"型号",key:"PartNumber",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.Product.PartNumber},on:{"on-change":function(e){a.row.Product.PartNumber=e.target.value,r.Storages[a.index]=a.row}}})}},{title:"品牌",key:"Manufacturer",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.Product.Manufacturer},on:{"on-change":function(e){a.row.Product.Manufacturer=e.target.value,r.Storages[a.index]=a.row}}})}},{title:"批号",key:"DateCode",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.DateCode},on:{"on-change":function(e){a.row.DateCode=e.target.value,r.Storages[a.index]=a.row}}})}},{title:"数量",key:"Quantity",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.Quantity},on:{"on-change":function(e){a.row.Quantity=e.target.value,r.Storages[a.index]=a.row},"on-blur":function(){if(""!=event.target.value){1==/^\d+(\.\d{0,2})?$/.test(event.target.value)?(a.row.Quantity=event.target.value,r.Storages[a.index]=a.row):(r.$Message.error("只能输入数量"),event.target.value="",a.row.Quantity="",r.Storages[a.index]=a.row)}}}})}},{title:"原产地",slot:"Place"}],Storages:[{WareHouseID:sessionStorage.getItem("UserWareHouse"),Quantity:"",ShelveID:"",DateCode:"",Place:"",Product:{PartNumber:"",Manufacturer:""}}],Summaryarr:[{title:"",slot:"indexs",width:30,align:"center"},{title:"操作",slot:"action",width:100,align:"center"},{title:"描述",key:"Summary",render:function(t,a){var r=e;return t("Input",{props:{value:a.row.Summary},on:{"on-change":function(e){a.row.Summary=e.target.value,r.Summarydata[a.index]=a.row}}})}}],Summarydata:[{WareHouseID:sessionStorage.getItem("UserWareHouse"),Quantity:0,ShelveID:"",Summary:""}],objs:{}}},created:function(){console.log("暂存页加载"),window.PhotoUploaded=this.changed,this.getWayParter(),this.Carriers(),this.GetUsableShelves(),console.log(this.WareHouseID)},mounted:function(){},methods:{Initialization:function(e){var t=this,a={warehouseID:this.WareHouseID,waybillID:e};Object(o.G)(a).then(function(e){console.log(e),t.objs=e.obj,t.Code=e.obj.Code,t.CarrierID=e.obj.CarrierID,t.ConsignorID=e.obj.Consignor.Contact,t.Place=e.obj.Consignor.Place,t.phonenumber=e.obj.Consignor.Phone,t.ConsignorName=e.obj.Consignor.Contact,t.EnterCode=e.obj.EnterCode,t.Summary=e.obj.Summary,t.Files=e.obj.Files,t.waybillid=e.obj.WaybillID,t.Consignorid=e.obj.ConsignorID,e.obj.ProductStorages.length<=0?t.Storages=[{WareHouseID:sessionStorage.getItem("UserWareHouse"),Quantity:"",ShelveID:"",DateCode:"",Place:"",Product:{PartNumber:"",Manufacturer:""}}]:t.Storages=e.obj.ProductStorages,e.obj.SummaryStorages.length<=0?t.Summarydata=[{WareHouseID:sessionStorage.getItem("UserWareHouse"),Quantity:0,ShelveID:"",Summary:""}]:t.Summarydata=e.obj.SummaryStorages,e.obj.SummaryStorages.length>0?t.ShelveID=t.Summarydata[0].ShelveID:t.ShelveID=t.Storages[0].ShelveID})},addrow:function(e){console.log(e);var t={WareHouseID:sessionStorage.getItem("UserWareHouse"),Quantity:"",ShelveID:"",DateCode:"",Place:"",Product:{PartNumber:"",Manufacturer:""}};this.Storages.splice(e+1,0,t)},addSummary:function(e){var t={WareHouseID:sessionStorage.getItem("UserWareHouse"),Quantity:0,ShelveID:"",Summary:""};this.Summarydata.splice(e+1,0,t)},delrow:function(e,t){"Summary"==t?this.Summarydata.splice(e,1):this.Storages.splice(e,1)},getWayParter:function(){var e=this;Object(o.S)().then(function(t){console.log(t),e.Conveyingplace=t.obj})},Carriers:function(){var e=this;Object(o.d)().then(function(t){e.CarrierList=t.obj})},GetUsableShelves:function(){var e=this,t=sessionStorage.getItem("UserWareHouse");console.log(t),Object(o.w)(t).then(function(t){console.log(t),e.ShelveArr=t.obj})},submitbtn:function(){var e=this,t="",a="",r=[],i=[];if(1==this.Summarydata.length&&""==this.Summarydata[0].Summary)t=!1;else if(t=!0,this.Summarydata.length>=1)for(var s=0;s<this.Summarydata.length;s++)""!=this.Summarydata[s].Summary&&r.push(this.Summarydata[s]);if(1==this.Storages.length&&""==this.Storages[0].Product.PartNumber)a=!1;else{a=!0;for(s=0;s<this.Storages.length;s++)""!=this.Storages[s].Product.PartNumber&&i.push(this.Storages[s])}if(1==t||1==a||this.$Message.error("请输入产品信息或描述信息"),""==this.ShelveID)this.$Message.error("请输暂存库位");else{var l="";if(1==t||1==a)if(i.map(function(t){t.ShelveID=e.ShelveID,l=""==t.Quantity||""==t.Place}),r.map(function(t){t.ShelveID=e.ShelveID}),1==l)this.$Message.error("数量与产地为必填");else{var c={WaybillID:this.waybillid,Code:this.Code,WaybillType:3,CarrierID:this.CarrierID,ExcuteStatus:300,Files:this.Files,EnterCode:this.EnterCode,Summary:this.Summary,SummaryStorages:r,ConsignorID:this.Consignorid,Consignor:{Contact:this.ConsignorName,Phone:this.phonenumber,Place:this.Place},ProductStorages:i};console.log(c);var u={obj:n()(c)};Object(o.J)(u).then(function(t){if(console.log(t),0==t.val){e.$Message.success("修改成功,两秒后关闭该页面");var a=e;setTimeout(function(){a.$emit("uploadlist")},2e3)}else e.$Message.error("修改失败，请检查录入信息是否正确")})}}},changeimgs:function(e,t){"webaill"==t&&this.Files.push(e)},delimg:function(e){this.Files.splice(this.Files.indexOf(e),1),console.log(this.Files)},fromphotos:function(){var e={SessionID:"zancun",AdminID:sessionStorage.getItem("userID")};Object(i.b)(e)},SeletUpload:function(e){if("Waybill"==e){var t={SessionID:this.waybillid,AdminID:sessionStorage.getItem("userID")};Object(i.l)(t)}},changed:function(e){this.testfunction(e)},testfunction:function(e){var t=e[0],a={CustomName:t.FileName,ID:t.FileID,Url:t.Url,type:8e3};this.Files.push(a)},setphone:function(){if(""!=this.phonenumber){var e=/(^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$)/.test(this.phonenumber);console.log(e),this.disabledphone=e,0==e&&(this.$Message.error("请输入正确的手机号"),this.phonenumber="")}},clear_btn:function(){this.Initialization(this.waybillid)},PictureShow:function(e){var t={Url:e};Object(i.g)(t)}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("p",{staticClass:"detailtitle"},[e._v("基础信息")]),e._v(" "),a("div",{staticClass:"box"},[a("Row",{staticStyle:{padding:"10px"}},[a("Col",{attrs:{xs:2,sm:4,md:6,lg:6}},[a("p",[a("label",[e._v("运  单  号：\n                            "),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入运单号"},model:{value:e.Code,callback:function(t){e.Code=t},expression:"Code"}})],1)]),e._v(" "),a("p",{staticStyle:{"padding-top":"10px"}},[a("label",[e._v("入  仓  号：\n                        "),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入入仓号"},model:{value:e.EnterCode,callback:function(t){e.EnterCode=t},expression:"EnterCode"}})],1)]),e._v(" "),a("p",{staticStyle:{width:"172%","padding-top":"10px"}},[a("label",[e._v("备        注：\n                          "),a("Input",{staticStyle:{width:"90%",float:"right"},attrs:{type:"textarea",autosize:{maxRows:3,minRows:3},placeholder:"请输入备注信息"},model:{value:e.Summary,callback:function(t){e.Summary=t},expression:"Summary"}})],1)])]),e._v(" "),a("Col",{attrs:{xs:20,sm:16,md:12,lg:6}},[a("p",[a("label",[e._v("承   运    商：\n                        "),a("Select",{staticStyle:{width:"200px"},model:{value:e.CarrierID,callback:function(t){e.CarrierID=t},expression:"CarrierID"}},e._l(e.CarrierList,function(t){return a("Option",{key:t.ID,attrs:{value:t.ID}},[e._v(e._s(t.Name))])}),1)],1)]),e._v(" "),a("p",{staticStyle:{"padding-top":"10px"}},[a("label",[e._v("发货人姓名：\n                        "),a("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入发货人姓名"},model:{value:e.ConsignorName,callback:function(t){e.ConsignorName=t},expression:"ConsignorName"}})],1)])]),e._v(" "),a("Col",{attrs:{xs:2,sm:4,md:6,lg:6}},[a("p",[a("label",[e._v("输   送    地：\n                            "),a("Select",{staticStyle:{width:"200px"},model:{value:e.Place,callback:function(t){e.Place=t},expression:"Place"}},e._l(e.Conveyingplace,function(t){return a("Option",{key:t.ID,attrs:{value:t.CorPlace}},[e._v(e._s(t.Text))])}),1)],1)]),e._v(" "),a("p",{staticStyle:{"padding-top":"10px"}},[a("label",[e._v("发货人电话：\n                         "),a("Input",{staticStyle:{width:"200px"},attrs:{type:"tel",placeholder:"请输入发货人电话"},on:{"on-blur":e.setphone},model:{value:e.phonenumber,callback:function(t){e.phonenumber=t},expression:"phonenumber"}})],1)]),e._v(" "),a("p",{staticStyle:{"padding-top":"10px"}},[a("label",[a("em",{staticClass:"bitian"},[e._v("*")]),e._v("暂 存 库 位：\n                        "),e._v(" "),a("Select",{staticStyle:{width:"200px"},model:{value:e.ShelveID,callback:function(t){e.ShelveID=t},expression:"ShelveID"}},e._l(e.ShelveArr,function(t){return a("Option",{key:t.ID,attrs:{value:t.ID}},[e._v(e._s(t.ID))])}),1)],1)])]),e._v(" "),a("Col",{attrs:{xs:2,sm:4,md:6,lg:6}},[a("div",{staticClass:"setupload"},[a("Button",{attrs:{type:"primary",size:"small",icon:"ios-cloud-upload"},on:{click:function(t){return e.SeletUpload("Waybill")}}},[e._v("传照")])],1),e._v(" "),a("div",{staticClass:"setupload",staticStyle:{float:"rigth"}},[a("Button",{attrs:{size:"small",type:"primary",icon:"md-reverse-camera"},on:{click:function(t){return e.fromphotos()}}},[e._v("拍照")])],1),e._v(" "),a("ul",{staticStyle:{clear:"both"}},e._l(e.Files,function(t){return 8e3==t.Type?a("li",[a("p",[a("span",{on:{click:function(a){return e.PictureShow(t.Url)}}},[e._v(e._s(t.CustomName))]),e._v(" "),a("Icon",{staticClass:"iconstyle",attrs:{type:"md-trash"},on:{click:function(a){return e.delimg(t)}}})],1)]):e._e()}),0)])],1)],1)]),e._v(" "),a("div",[a("div",{staticStyle:{"padding-top":"10px"}},[a("p",{staticClass:"detailtitle"},[e._v("描述信息")]),e._v(" "),a("div",{staticStyle:{"padding-top":"10px"}},[a("Table",{attrs:{columns:e.Summaryarr,data:e.Summarydata},scopedSlots:e._u([{key:"indexs",fn:function(t){t.row;var a=t.index;return[e._v(e._s(a+1))]}},{key:"action",fn:function(t){t.row;var r=t.index;return[a("Icon",{staticStyle:{"margin-right":"5px","font-size":"20px","font-width":"600"},attrs:{type:"ios-add-circle-outline"},on:{click:function(t){return e.addSummary(r)}}}),e._v(" "),a("Icon",{staticStyle:{"font-size":"20px","font-width":"600"},attrs:{type:"ios-trash-outline"},on:{click:function(t){return e.delrow(r,"Summary")}}})]}}])})],1)]),e._v(" "),a("div",{staticStyle:{"padding-top":"30px"}},[a("p",{staticClass:"detailtitle"},[e._v("产品信息")]),e._v(" "),a("div",{staticStyle:{"padding-top":"10px"}},[a("Table",{attrs:{columns:e.columns7,data:e.Storages},scopedSlots:e._u([{key:"indexs",fn:function(t){t.row;var a=t.index;return[e._v(e._s(a+1))]}},{key:"action",fn:function(t){t.row;var r=t.index;return[a("Icon",{staticStyle:{"margin-right":"5px","font-size":"20px","font-width":"600"},attrs:{type:"ios-add-circle-outline"},on:{click:function(t){return e.addrow(r)}}}),e._v(" "),a("Icon",{staticStyle:{"font-size":"20px","font-width":"600"},attrs:{type:"ios-trash-outline"},on:{click:function(t){return e.delrow(r,"product")}}})]}},{key:"Place",fn:function(t){var r=t.row;return t.index,[a("Select",{staticStyle:{width:"200px"},attrs:{transfer:!0,filterable:""},model:{value:r.Place,callback:function(t){e.$set(r,"Place",t)},expression:"row.Place"}},e._l(e.Conveyingplace,function(t){return a("Option",{key:t.ID,attrs:{value:t.CorPlace}},[e._v(e._s(t.Text))])}),1)]}}])}),e._v(" "),a("div",{staticClass:"buttons"},[a("Button",{attrs:{size:"large"},on:{click:e.clear_btn}},[e._v("取消修改")]),e._v(" "),a("Button",{staticStyle:{"margin-rigth":"5px"},attrs:{type:"primary",size:"large"},on:{click:e.submitbtn}},[e._v("保存")])],1)],1)])])])},staticRenderFns:[]};var c=a("VU/8")(s,l,!1,function(e){a("0Uva")},"data-v-3cd0db8e",null);t.default=c.exports}});
//# sourceMappingURL=10.8276e3abcb167eb01722.js.map