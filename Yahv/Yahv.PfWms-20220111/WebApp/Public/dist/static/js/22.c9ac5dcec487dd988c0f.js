webpackJsonp([22],{"Z/JF":function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_reflect_set__=__webpack_require__("/XOS"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_reflect_set___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_reflect_set__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty__=__webpack_require__("bOdI"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_3__Pages_Common_imgtes__=__webpack_require__("Wxb1"),__WEBPACK_IMPORTED_MODULE_4__Pages_Common_Photograph__=__webpack_require__("7GJn"),__WEBPACK_IMPORTED_MODULE_5__Pages_Common_Historygoods__=__webpack_require__("EE7l"),__WEBPACK_IMPORTED_MODULE_6__api__=__webpack_require__("gyMJ"),__WEBPACK_IMPORTED_MODULE_7__js_browser_js__=__webpack_require__("3PyT"),__WEBPACK_IMPORTED_MODULE_8_jquery__=__webpack_require__("7t+N"),__WEBPACK_IMPORTED_MODULE_8_jquery___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_jquery__),__WEBPACK_IMPORTED_MODULE_9_vue__=__webpack_require__("7+uW"),__WEBPACK_IMPORTED_MODULE_10_moment__=__webpack_require__("PJh5"),__WEBPACK_IMPORTED_MODULE_10_moment___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_moment__),Base64=__webpack_require__("xrTZ").Base64,product_url=__webpack_require__("FHte"),lodash=__webpack_require__("M4fF");__webpack_exports__.a={name:"RoutineEnter",components:{"img-test":__WEBPACK_IMPORTED_MODULE_3__Pages_Common_imgtes__.default,"photo-graph":__WEBPACK_IMPORTED_MODULE_4__Pages_Common_Photograph__.default,"Historys-dom":__WEBPACK_IMPORTED_MODULE_5__Pages_Common_Historygoods__.default},props:{fatherMethod:{type:Function,default:null}},data:function(){var t=this;return{TakeGoodsName:"我去提货",Conditionstype:!0,printurl:product_url.pfwms,loading:!0,printlist:[],Conveyingplace:[],Conveyingplace2:[],ConveyingplaceID:"",chengevalue:{inputval:"",value:"",type:""},setClientCode:!1,ClientCode:"",model11:"",sethousbox:!1,housenumber:"",Storehouselist:[],detail_ID:"",searchkey:"",showphoto2:!1,time:"",WarehousingMsg:!1,Nomatching:[],details:{waybillinfo:{},wayBillID:"",total:0,pageIndex:1,pageSize:1e4,WaybillNo:"90416165067",Conveyorsite:"",columns1:[{type:"selection",width:50,align:"center"},{title:"# ",slot:"indexs",align:"left",width:30},{title:"型号",key:"PartNumber",render:function(e,i){var a=t;return 0==i.row.iscx?e("span",{},i.row.Product.PartNumber):e("Input",{props:{value:i.row.Product.PartNumber},on:{"on-change":function(t){i.row.Product.PartNumber=t.target.value,a.details.detailitem[i.index]=i.row;for(var e=a.details.detailitem,l=0;l<e.length;l++)e[l].PID==i.row.ID&&(e[l].Product.PartNumber=t.target.value);a.clicktest(i.row)}}})}},{title:"品牌",key:"Manufacturer",render:function(e,i){var a=t;return 0==i.row.iscx?e("span",{},i.row.Product.Manufacturer):e("Input",{props:{value:i.row.Product.Manufacturer},on:{"on-change":function(t){i.row.Product.Manufacturer=t.target.value,a.details.detailitem[i.index]=i.row;for(var e=a.details.detailitem,l=0;l<e.length;l++)e[l].PID==i.row.ID&&(e[l].Product.Manufacturer=t.target.value);a.clicktest(i.row)}}})}},{title:"已到/应到",slot:"Arrival",align:"center"},{title:"批次",key:"DateCode",align:"center",render:function(e,i){var a=t;return e("Input",{props:{value:i.row.Input.DateCode},on:{"on-change":function(t){i.row.Input.DateCode=t.target.value,a.details.detailitem[i.index]=i.row,a.clicktest(i.row)}}})}},{title:"本次到货",key:"TruetoQuantity",align:"center",render:function(e,i){var a=t;return console,0==i.row.Enabled?e("Input",{props:{value:i.row.TruetoQuantity,disabled:!0},on:{"on-change":function(t){},"on-blur":function(t){}}}):0==i.row.iscx?e("Input",{props:{value:i.row.TruetoQuantity},on:{"on-change":function(t){1==/^\d+(\.\d{0,2})?$/.test(t.target.value)?(i.row.TruetoQuantity=t.target.value,a.details.detailitem[i.index]=i.row,a.clicktest(i.row)):(a.$Message.error("只能输入正整数"),t.target.value="",i.row.TruetoQuantity="",a.details.detailitem[i.index]=i.row)},"on-blur":function(t){if(console.log(t.target.value),""!=t.target.value){1==/^\d+(\.\d{0,2})?$/.test(t.target.value)?(i.row.TruetoQuantity=t.target.value,a.details.detailitem[i.index]=i.row):(a.$Message.error("只能输入正整数"),t.target.value="",i.row.TruetoQuantity="",a.details.detailitem[i.index]=i.row)}}}}):e("Input",{props:{value:i.row.TruetoQuantity},on:{"on-change":function(t){1==/^\d+(\.\d{0,2})?$/.test(t.target.value)?(i.row.TruetoQuantity=t.target.value,a.details.detailitem[i.index]=i.row,a.clicktest(i.row)):t.target.value<0?(t.target.value="",i.row.TruetoQuantity="",a.details.detailitem[i.index]=i.row):(a.$Message.error("只能输入正整数"),t.target.value="",i.row.TruetoQuantity="",a.details.detailitem[i.index]=i.row)},"on-blur":function(t){if(""!=t.target.value){1==/^\d+(\.\d{0,2})?$/.test(t.target.value)?(i.row.TruetoQuantity=t.target.value,a.details.detailitem[i.index]=i.row):(a.$Message.error("只能输入正整数"),t.target.value="",i.row.TruetoQuantity="",a.details.detailitem[i.index]=i.row)}}}})}},{title:"原产地",slot:"OriginDes",align:"left"},{title:"入库库位",slot:"ShelveID",align:"left",width:135},{title:"体积(m³)",key:"Volume",align:"center",render:function(e,i){var a=t;return e("Input",{props:{value:i.row.Volume},on:{"on-change":function(t){1==/^\d+(\.\d{0,2})?$/.test(t.target.value)?(i.row.Volume=t.target.value,a.details.detailitem[i.index]=i.row):(a.$Message.error("只能输入数字,包括两位数的小数点"),t.target.value="",i.row.Volume="",a.details.detailitem[i.index]=i.row)},"on-blur":function(){1==/^\d+(\.\d{0,2})?$/.test(event.target.value)?(i.row.Volume=event.target.value,a.details.detailitem[i.index]=i.row):(a.$Message.error("只能输入数字,包括两位数的小数点"),event.target.value="",i.row.Volume="",a.details.detailitem[i.index]=i.row)}}})}},{title:"毛重(kg)",key:"Weight",align:"center",render:function(e,i){var a=t;return e("Input",{props:{value:i.row.Weight,autofocus:!0},on:{"on-change":function(t){},"on-blur":function(t){var e=a.trim(t.target.value);""!=e&&(1==/^\d+(\.\d{0,2})?$/.test(e)?(i.row.Weight=e,a.details.detailitem[i.index]=i.row):(a.$Message.error("只能输入数字,包括两位数的小数点"),i.row.Weight="",t.target.value="",a.details.detailitem[i.index]=i.row))},"on-enter":function(e){var l=a.trim(e.target.value);if(1==/^\d+(\.\d{0,2})?$/.test(l)){i.row.Weight=l,a.details.detailitem[i.index]=i.row;var o={Quantity:i.row.Quantity,inputsID:i.row.SortingID,Catalog:"",PartNumber:i.row.Product.PartNumber,Manufacturer:i.row.Product.Manufacturer,Packing:i.row.Product.Packing,PackageCase:i.row.Product.PackageCase,origin:i.row.origintext},s=[];s.push(o);var n=Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.e)()["产品标签"],r=-1!=n.Url.indexOf("http");n.Url=1==r?n.Url:t.printurl+n.Url;var _={setting:n,data:s};Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.n)(_)}else a.$Message.error("只能输入数字,包括两位数的小数点"),i.row.Weight="",e.target.value="",a.details.detailitem[i.index]=i.row}}})}},{title:"图片",slot:"imglist",align:"center",width:190},{title:"操作",slot:"operation",align:"center",width:210}],data1:[{iscx:!0,ID:"1",Model:"MPX68HFHDGF",brand:"FREESCEE",batch:"1032",Shouldarrive:"5000",Alreadyarrived:"500",Quantity:"50",StockCode:"558",Country_origin:"美国",volume:"50",GrossWeight:"50000",uploadimg:[]},{iscx:!0,ID:"2",Model:"MPX68HFHDGF",brand:"FREESCEE",batch:"1032",Shouldarrive:"1000",Alreadyarrived:"200",Quantity:"20",StockCode:"258",Country_origin:"香港",volume:"50",GrossWeight:"50000",uploadimg:[]},{iscx:!0,ID:"3",Model:"MPX68HFHDGF",brand:"FREESCEE",batch:"33333",Shouldarrive:"33333",Alreadyarrived:"3333",Quantity:"3333",StockCode:"33333",Country_origin:"北京",volume:"50",GrossWeight:"50000",uploadimg:[]},{iscx:!0,ID:"4",Model:"MPX68HFHDGF",brand:"FREESCEE",batch:"1032",Shouldarrive:"1000",Alreadyarrived:"200",Quantity:"20",StockCode:"258",Country_origin:"香港",volume:"50",GrossWeight:"50000",uploadimg:[]}],detailitem:[],fathertype:""},uploadList:[],files:"",SelectRow:[],isAbnormal:!1,remarks:"",Reason:"外观损坏",errordata:[{value:"外观损坏",label:"外观损坏"},{value:"产品数量不相符",label:"产品数量不相符"},{value:"产品型号不相符",label:"产品型号不相符"},{value:"参数不相符（批次/产地）",label:"参数不相符（批次/产地）"},{value:"包装受潮严重",label:"包装受潮严重"},{value:"其他",label:"其他"}],Summary:{},historydata:!1,historydetail:{times:"",waybillLIst:[]},company:"",CarrierList:[],filterarr:[],Driversarr:[],CarArr:[]}},filters:{showDate:function(t){if(""!=t&&t){var e=t.split("(")[1].split(")")[0];return __WEBPACK_IMPORTED_MODULE_10_moment___default()(+e).format("YYYY-MM-DD")}},changenumber:function(t){if(""!=t){var e=Number(t);return console.log(e),e}}},computed:{getarrs:function(){return this.Nomatching},Budgetdetail:function(){return this.$store.state.common.Budgetdetail}},mounted:function(){},created:function(){this.Carriers(),this.settimeouts&&clearTimeout(this.settimeouts),this.setIntervaltimer&&clearTimeout(this.setIntervaltimer),window.PhotoUploaded=this.changed},beforeRouteUpdate:function(t,e,i){console.log(t),console.log(e),console.log(i),i()},methods:{clicktest:lodash.throttle(function(t){var e=t,i=this.details.detailitem;Object(__WEBPACK_IMPORTED_MODULE_6__api__.q)().then(function(t){if(t)for(var a=t.id,l=0;l<i.length;l++)i[l].InputID==e.InputID&&(i[l].InputID=a,i[l].Input.ID=a,i[l].Input.Code=a)})},1e3),trim:function(t){return t.replace(/(^\s*)|(\s*$)/g,"")},ok:function(){this.$Message.info("Clicked ok"),this.showphoto2=!1},cancel:function(){this.$Message.info("取消"),this.showphoto2=!1,this.sethousbox=!1},handleSelectRow:function(t){this.SelectRow=t},search_pro:function(){var t=this;console.log(this.searchkey);var e=sessionStorage.getItem("UserWareHouse");Object(__WEBPACK_IMPORTED_MODULE_6__api__._1)(e,this.details.wayBillID,encodeURI(this.searchkey)).then(function(e){console.log(e),""!=e.obj&&(t.details.detailitem=e.obj.Notices)})},finish_btn:function finish_btn(){for(var isnull=null,that=this,dataarr=this.details.detailitem,null_num=1,i=0;i<dataarr.length;i++)""==dataarr[i].TruetoQuantity?(isnull=!0,null_num++):(isnull=!1,null_num=1);function sum(arr){return eval(arr.join("+"))}for(var arr=dataarr,Nomatching=[],map={},dest=[],i=0;i<arr.length;i++){var ai=arr[i];if(map[ai.PID])for(var j=0;j<dest.length;j++){var dj=dest[j];if(dj.PID==ai.PID){dj.data.push(Number(ai.TruetoQuantity));break}}else dest.push({name:ai.Product.PartNumber,Quantity:ai.Quantity,PID:ai.PID,data:[Number(ai.TruetoQuantity)]}),map[ai.PID]=ai.PID}for(var i=0;i<dest.length;i++){var item=dest[i],total=sum(item.data);console.log(total),(item.Quantity<total||item.Quantity>total)&&Nomatching.push(item.name)}that.Nomatching=Nomatching,that.WarehousingMsg=!0},setWarehousing:function(t){var e=this;Object(__WEBPACK_IMPORTED_MODULE_6__api__._2)(t).then(function(t){if(0==t.val){if(40==e.details.waybillinfo.Source){e.$Message.success("该订单为转运订单，两秒后跳转至出库处理页面");var i=e;setTimeout(function(){i.toout_btn(t.id)},2e3)}else if(e.fatherMethod){e.$Message.success("操作完成，一秒后自动关闭");i=e;setTimeout(function(){i.fatherMethod()},1e3)}}else if(400==t.val){if(e.fatherMethod){e.$Message.error("此订单已被关闭，请处理其他订单");i=e;setTimeout(function(){i.fatherMethod()},2e3)}}else 500==t.val?e.$Message.error("请输入数量，数量不能为空"):e.$Message.error("入库操作失败,请从新操作")})},getCookie:function(t){for(var e=document.cookie.split("; "),i=0;i<e.length;i++){var a=e[i].split("=");if(t==a[0])return a[1]}return""},ok_Warehousing:function(){console.log(this.details.detailitem),this.details.waybillinfo.Notices=this.details.detailitem;var t={obj:__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default()(this.details.waybillinfo),Status:120,token:this.getCookie("ydcx_Yahv.Erp"),Summary:""};this.setWarehousing(t),this.WarehousingMsg=!1},cancel_Warehousing:function(){this.WarehousingMsg=!1},changeimgs:function(t,e){for(var i=this.details.detailitem,a=0,l=i.length;a<l;a++)i[a].ID==e.ID&&i[a].Files.push(t)},chaixiang:function(t,e){var i=this,a="";Object(__WEBPACK_IMPORTED_MODULE_6__api__.q)().then(function(l){var o;console.log(l),a=l.id;var s=(o={iscx:!1,Enabled:!0,BoxCode:e.BoxCode,CheckValue:e.CheckValue,IsOriginalNotice:!1,Condition:e.Condition,DateCode:e.DateCode,Files:[],ID:"CX"+t+(new Date).getTime(),PID:e.ID,WareHouseID:e.WareHouseID,WayBillID:e.WayBillID,ProductID:e.ProductID,InputID:a,ClientID:e.ClientID,Input:e.Input,Product:e.Product,Quantity:e.Quantity,ShelveID:e.ShelveID,SortedQuantity:e.SortedQuantity,Source:e.Source,TruetoQuantity:e.TruetoQuantity,Volume:e.Volume},__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default()(o,"WayBillID",e.WayBillID),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default()(o,"Weight",e.Weight),o);s.Input.ID=a,s.Input.Code=a,console.log(s),i.details.detailitem.splice(t+1,0,s)})},removechaixiang:function(t){this.details.detailitem.splice(t,1)},getdetail_data:function(t){var e=this;if(""!=t){this.details.wayBillID=t;var i={waybillid:this.details.wayBillID};this.History(i);var a={warehouseID:sessionStorage.getItem("UserWareHouse"),wayBillID:this.details.wayBillID,pageIndex:this.details.pageIndex,pageSize:this.details.pageSize};Object(__WEBPACK_IMPORTED_MODULE_6__api__.B)(a).then(function(t){var i=t.obj.Notices,a=i.length;console.log(t.obj.Notices);for(var l=t.obj.Notices,o=0;o<l.length;o++)if(l[o].Sorted.length>0)for(var s=l[o].Sorted,n=0;n<s.length;n++){__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_reflect_set___default()(s[n],"iscx",!1);var r=s[n];l.splice(o+1,0,r)}for(o in e.details.detailitem=l,e.details.waybillinfo=t.obj,e.GetUsableShelves(),e.loading=!1,t.obj.Conditions){if(1==t.obj.Conditions[o]){e.Conditionstype=!0;break}e.Conditionstype=!1}for(o=0;o<a;o++){var _={PartNumber:i[o].Product.PartNumber,Manufacturer:i[o].Product.Manufacturer,Quantity:i[o].Quantity,SortedQuantity:i[o].SortedQuantity,DateCode:i[o].Input.DateCode,TruetoQuantity:"",Origin:i[o].Input.OriginDescription,ShelveID:i[o].ShelveID,Volume:i[o].Volume,Weight:i[o].Weight};e.printlist.push(_)}})}},detailspage:function(t){console.log(this.details.wayBillID),this.details.pageIndex=t,this.getdetail_data(this.details.wayBillID)},handleBeforeUpload:function(t){var e=new FileReader;e.readAsDataURL(t);var i=this;return e.onloadend=function(a){t.url=e.result;var l={AdminID:"",ClientID:"",CreateDate:"",CustomName:t.name,FileBase64Code:t.url,ID:"",InputID:"",LocalFile:"",Status:0,StatusDes:"",StorageID:"",Type:0,TypeDes:"",Url:"",WaybillID:""};i.details.waybillinfo.Files.push(l)},!1},handleRemove:function(t){this.details.waybillinfo.Files.splice(this.details.waybillinfo.Files.indexOf(t),1)},handleFormatError:function(t){this.$Notice.warning({title:"文件格式不正确",desc:"文件 "+t.name+" 格式不正确，请上传 jpg 或 png 格式的图片。"})},handleMaxSize:function(t){this.$Notice.warning({title:"超出文件大小限制",desc:"文件 "+t.name+" 太大，不能超过 2M。"})},handleRemovelist:function(t,e){for(var i=this.details.detailitem,a=0;a<i.length;a++)i[a].ID==t.ID&&i[a].Files.splice(e,1)},closephoto:function(){this.$refs.photograph.closeCamera();var t=this;setTimeout(function(){t.showphoto2=!1},20)},upload_btn:function(){this.$refs.photograph.uploadphoto();var t=this;setTimeout(function(){t.showphoto2=!1},20)},photoing:function(t){console.log(t),this.fathertype=t,this.showphoto2=!0,this.$refs.photograph.closeCamera(),this.$refs.photograph.list=[],this.$refs.photograph.model1="",this.$refs.photograph.setCamera(),this.$refs.photograph.callCamera()},changupload:function(t,e){if("waybill"==this.fathertype)this.details.waybillinfo.Files.push(t);else for(var i=this.details.detailitem,a=0;a<i.length;a++)i[a].ID==this.fathertype.ID&&i[a].Files.push(t)},GetUsableShelves:function(){var t=this,e=sessionStorage.getItem("UserWareHouse");Object(__WEBPACK_IMPORTED_MODULE_6__api__.w)(e,this.details.waybillinfo.ClientID).then(function(e){t.Storehouselist=e.obj})},SetStorehouse:function(){this.SelectRow.length<=0?this.$Message.error("请选择要操作的产品项"):this.sethousbox=!0},changehouse:function(){for(var t=this.SelectRow,e=(this.details.detailitem,0);e<this.details.detailitem.length;e++)for(var i=0;i<t.length;i++)this.details.detailitem[e].ID==t[i].ID&&1==this.details.detailitem[e].Enabled&&(this.details.detailitem[e].ShelveID=this.housenumber);this.SelectRow=[],this.sethousbox=!1,this.$refs.selection.selectAll(!1)},isAbnormalclick:function(){this.isAbnormal=!0},Abnormal_btn:function(){if(void 0==this.Summary.Summary||""==this.Summary.Summary)this.isAbnormal=!0,this.$Message.error("请输入异常原因");else{this.details.waybillinfo.Notices=this.details.detailitem,this.Summary.Title=this.Reason;var t={obj:__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default()(this.details.waybillinfo),token:this.getCookie("ydcx_Yahv.Erp"),Summary:this.Summary.Summary,Status:130};this.details.detailitem.length>0?this.setWarehousing(t):this.$Message.error("暂无数据"),this.isAbnormal=!1}},closeerror:function(){this.Summary.Summary="",this.Reason="外观损坏",this.isAbnormal=!1},changeerror:function(t){1==t?this.isAbnormal=!0:(this.isAbnormal=!1,this.Summary.Summary="")},Labelprint:function(){var t=this.SelectRow,e=[];if(t.length<=0)this.$Message.error("请选择要操作的产品项");else{for(var i=0;i<t.length;i++){t[i].Inputs,t[i].StandardProducts;var a={Quantity:t[i].Quantity,inputsID:t[i].InputID,Catalog:t[i].Product.Catalog,PartNumber:t[i].Product.PartNumber,Manufacturer:t[i].Product.Manufacturer,Packing:t[i].Product.Packing,PackageCase:t[i].Product.PackageCase,origin:t[i].Input.OriginDescription};e.push(a)}var l=Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.e)()["产品标签"],o=-1!=l.Url.indexOf("http");l.Url=1==o?l.Url:this.printurl+l.Url;var s={setting:l,data:e};Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.n)(s)}},showhistory:function(t){this.historydata=!0,this.historydetail.times=(new Date).getTime();var e=this,i={waybillid:t.trim().split(/\s+/)[0]};setTimeout(function(){e.$refs.Historygoods.gethistory(i)},20)},historywaybill:function(t){this.details.wayBillID},WayParterdata:function(){var t=this;Object(__WEBPACK_IMPORTED_MODULE_6__api__.S)().then(function(e){t.Conveyingplace=e.obj})},Carriers:function(){var t=this;Object(__WEBPACK_IMPORTED_MODULE_6__api__.d)().then(function(e){t.CarrierList=e.obj})},detailelist:function(){if(this.printlist.length>0){this.details.waybillinfo,this.printlist;var t=Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.e)(),e=(this.details.waybillinfo,this.printlist,t["清单打印"]),i=-1!=e.Url.indexOf("http");e.Url=1==i?e.Url:this.printurl+e.Url;var a={setting:e,data:[{waybill:this.details.waybillinfo,listdata:this.printlist}]};Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.n)(a)}},changConveyingplace:function(t,e,i){console.log(t),console.log(e),console.log(i),void 0!=t&&(this.details.detailitem[i].ShelveID=t.value)},showBudget:function(){this.$store.dispatch("setBudget",!0),this.$router.push({name:"ends_meet",params:{webillID:this.details.waybillinfo.WaybillID,otype:"in"}})},closeBudget:function(){this.$router.go(-1),this.$store.dispatch("setBudget",!1)},History:function(t){var e=this;Object(__WEBPACK_IMPORTED_MODULE_6__api__.y)(t).then(function(t){e.historydetail.waybillLIst=t.obj})},clickClient:function(t,e,i){console.log(t),console.log(e),console.log(i),this.setClientCode=!0,this.chengevalue.value=t,this.chengevalue.type=e,this.Conveyingplace2=this.Conveyingplace,this.ClientCode=String(t),this.ConveyingplaceID=i},changClientCode:function(t){this.chengevalue.inputval=t},primaryClientCode:function(){console.log(this.chengevalue),"ClientCode"==this.chengevalue.type?(this.details.waybillinfo.Place=this.chengevalue.inputval.value,this.details.waybillinfo.PlaceDescription=this.chengevalue.inputval.label):"ClientCode"!=this.ConveyingplaceID&&(this.chengevalue.type.Input.OriginDescription=this.chengevalue.inputval.label,this.details.detailitem[this.ConveyingplaceID].Input.Origin=this.chengevalue.inputval.value,this.details.detailitem[this.ConveyingplaceID].Input.OriginDescription=this.chengevalue.inputval.label),this.setClientCode=!1},fileprint:function(t){var e=Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.e)()["文档打印"];e.Url=t;var i=e;Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.a)(i)},imgprint:function(){var t=Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.e)()["图片打印"],e=-1!=t.Url.indexOf("http");t.Url=1==e?t.Url:this.printurl+t.Url;var i={setting:t,data:[{src:"C:\\Users\\Administrator\\Pictures\\test1.png"}]};Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.a)(i)},fromphotos:function(t){if("Waybill"==t){var e={SessionID:this.details.waybillinfo.WaybillID,AdminID:sessionStorage.getItem("userID")};Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.b)(e)}else{e={SessionID:t,AdminID:sessionStorage.getItem("userID")};Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.b)(e)}},changed:function(t){this.testfunction(t)},testfunction:function(t){var e=t[0],i={CustomName:e.FileName,ID:e.FileID,Url:e.Url,Type:8e3};if(e.SessionID==this.details.waybillinfo.WaybillID)this.details.waybillinfo.Files.push(i);else for(var a=0;a<this.details.detailitem.length;a++)this.details.detailitem[a].InputID==e.SessionID&&this.details.detailitem[a].Files.push(i)},SeletUpload:function(t){var e={SessionID:t,AdminID:sessionStorage.getItem("userID")};Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.l)(e)},TakeGoods:function(){var t=this,e={waybillid:this.details.waybillinfo.WaybillID};Object(__WEBPACK_IMPORTED_MODULE_6__api__.I)(e).then(function(e){1==e.val?(t.details.waybillinfo.ExcuteStatusDescription="正在提货中",t.TakeGoodsName="正在提货"):t.$Message.error("提货锁定失败")})},search_filter:function(){},rowClassName:function(t,e){return""!=this.searchkey?-1!==t.Product.PartNumber.indexOf(this.searchkey.toUpperCase())||-1!==t.Product.PartNumber.indexOf(this.searchkey.toLowerCase())||-1!==t.Product.Manufacturer.indexOf(this.searchkey.toUpperCase())||-1!==t.Product.Manufacturer.indexOf(this.searchkey.toLowerCase())?"":"demo-table-info-row":""},toout_btn:function(t){this.$store.dispatch("setshowdetail",!1),this.$store.dispatch("setshowdetailout",!0),this.$router.push({path:"/Outgoing/outdetail/"+t}),this.$store.dispatch("setshowtype",1),sessionStorage.setItem("Activename","出库管理"),this.$store.dispatch("setAcrivename","出库管理")},PictureShow:function(t){var e={Url:t};Object(__WEBPACK_IMPORTED_MODULE_7__js_browser_js__.g)(e)}}}},egD0:function(t,e){},tUW7:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Z/JF"),l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticStyle:{width:"100%"}},[i("div",{staticClass:"itembox"},[i("p",{staticClass:"detailtitle"},[t._v("基础信息")]),t._v(" "),i("div",{staticStyle:{width:"100%","min-height":"200px",background:"#f5f7f9",margin:"15px 0"}},[null!=t.details.waybillinfo?i("Row",[i("Col",{staticStyle:{width:"20%",float:"left"}},[i("ul",{staticClass:"detail_li detail1"},[i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title1"},[t._v("ID：")]),t._v(" "),i("span",[t._v(t._s(t.details.waybillinfo.WaybillID))])]),t._v(" "),i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title1"},[t._v("状态：")]),t._v(" "),i("span",[t._v(t._s(t.details.waybillinfo.ExcuteStatusDescription))])]),t._v(" "),i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title1"},[t._v("业务类型：")]),t._v(" "),i("span",[t._v(t._s(t.details.waybillinfo.SourceDescription))])]),t._v(" "),void 0!=t.details.waybillinfo.Conditions?i("li",{staticClass:"itemli"},[t.Conditionstype?i("Icon",{staticStyle:{"font-size":"22px",color:"#da2828"},attrs:{type:"md-alert"}}):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.AgencyCheck?i("Tag",{attrs:{color:"geekblue"}},[t._v("代检查")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.AgencyPayment?i("Tag",{attrs:{color:"purple"}},[t._v("代垫货款")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.AgencyReceive?i("Tag",{attrs:{color:"blue"}},[t._v("代收货款")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.ChangePackaging?i("Tag",{attrs:{color:"cyan"}},[t._v("代收货款")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.LableServices?i("Tag",{attrs:{color:"green"}},[t._v("标签服务")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.PayForFreight?i("Tag",{attrs:{color:"gold"}},[t._v("垫付运费")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.Repackaging?i("Tag",{attrs:{color:"orange"}},[t._v("重新包装")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.UnBoxed?i("Tag",{attrs:{color:"volcano"}},[t._v("拆箱验货")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.VacuumPackaging?i("Tag",{attrs:{color:"red"}},[t._v("真空包装")]):t._e(),t._v(" "),1==t.details.waybillinfo.Conditions.WaterproofPackaging?i("Tag",{attrs:{color:"magenta"}},[t._v("防水包装")]):t._e()],1):t._e()])]),t._v(" "),i("Col",{staticStyle:{width:"26%",float:"left"}},[i("ul",{staticClass:"detail_li"},[i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title2"},[t._v("通知时间：")]),t._v(" "),i("span",[t._v(t._s(t._f("showDate")(t.details.waybillinfo.CreateDate)))])]),t._v(" "),i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title2"},[t._v("供应商：")]),t._v(" "),i("span",[t._v(t._s(t.details.waybillinfo.Supplier))])]),t._v(" "),i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title2"},[t._v("到货方式：")]),t._v(" "),i("span",[t._v(t._s(t.details.waybillinfo.WaybillTypeDescription))]),t._v(" "),t.historydetail.waybillLIst.length>0?i("Badge",{attrs:{count:t.historydetail.waybillLIst.length,offset:[9,-12],"class-name":"demo-badge-alone"}},[i("Dropdown",{on:{"on-click":t.showhistory}},[i("a",{attrs:{href:"javascript:void(0)"}},[t._v("历史到货")]),t._v(" "),i("DropdownMenu",{attrs:{slot:"list"},slot:"list"},t._l(t.historydetail.waybillLIst,function(e,a){return i("DropdownItem",{key:a,attrs:{name:e}},[i("span",[t._v(t._s(e))])])}),1)],1)],1):t._e()],1),t._v(" "),i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title2"},[t._v("订单号：")]),t._v(" "),i("span",{staticStyle:{"line-height":"20px",width:"70%",display:"inline-block"}},[t._v(t._s(t.details.waybillinfo.OrderID))])])])]),t._v(" "),i("Col",{staticStyle:{width:"31%",float:"left"}},[i("ul",{staticClass:"detail_li"},[i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title3"},[t._v("入仓号：")]),t._v(" "),i("span",[t._v(t._s(t.details.waybillinfo.EnterCode))]),t._v(" "),i("em",[t._v("("+t._s(t.details.waybillinfo.ClientName)+")")])]),t._v(" "),i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title3"},[t._v("运单号(本次)：")]),t._v(" "),i("span",[i("Input",{staticStyle:{width:"60%"},model:{value:t.details.waybillinfo.Code,callback:function(e){t.$set(t.details.waybillinfo,"Code",e)},expression:"details.waybillinfo.Code"}})],1)]),t._v(" "),i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title3"},[t._v("承运商(本次):")]),t._v(" "),i("span",[i("Select",{staticStyle:{width:"60%"},model:{value:t.details.waybillinfo.CarrierID,callback:function(e){t.$set(t.details.waybillinfo,"CarrierID",e)},expression:"details.waybillinfo.CarrierID"}},t._l(t.CarrierList,function(e){return i("Option",{key:e.ID,attrs:{value:e.ID}},[t._v(t._s(e.Name))])}),1)],1)]),t._v(" "),i("li",{staticClass:"itemli"},[i("span",{staticClass:"detail_title3"},[t._v("输送地：")]),t._v(" "),i("span",[0!=t.details.waybillinfo.PlaceDescription?i("span",[t._v(t._s(t.details.waybillinfo.PlaceDescription))]):i("span",{staticStyle:{color:"red"}},[t._v("暂无输送地")]),t._v(" "),i("Icon",{staticClass:"sethover",attrs:{type:"md-create"},on:{click:function(e){return t.clickClient(t.details.waybillinfo.Place,"ClientCode","ClientCode")}}})],1)]),t._v(" "),1==t.details.waybillinfo.WaybillType?i("li",{staticClass:"itemli"},[i("div",{staticClass:"detail_title3",staticStyle:{float:"left"}},[t._v("提货文件：")]),t._v(" "),i("div",{staticStyle:{float:"left"}},t._l(t.details.waybillinfo.Files,function(e,a){return 10==e.Type?i("p",{staticClass:"setimgcolor"},[i("span",[t._v(t._s(e.CustomName))]),t._v(" "),i("span",{on:{click:function(i){return t.fileprint(e.Url)}}},[t._v("打印")])]):t._e()}),0)]):t._e()])]),t._v(" "),i("Col",{staticStyle:{width:"23%",float:"left"}},[i("ul",{staticClass:"detail_li",staticStyle:{"margin-left":"20px"}},[i("li",{staticClass:"itemli"},[i("div",{staticClass:"setupload"},[i("Button",{attrs:{type:"primary",size:"small",icon:"ios-cloud-upload"},on:{click:function(e){return t.SeletUpload(t.details.waybillinfo.WaybillID)}}},[t._v("传照")])],1),t._v(" "),i("div",{staticClass:"setupload"},[i("Button",{attrs:{type:"primary",icon:"md-reverse-camera"},on:{click:function(e){return t.fromphotos("Waybill")}}},[t._v("拍照")])],1)]),t._v(" "),i("li",{staticStyle:{clear:"both"}},t._l(t.details.waybillinfo.Files,function(e,a){return 8e3==e.Type?i("div",[i("p",{staticClass:"setimgcolor"},[i("span",{on:{click:function(i){return t.PictureShow(e.Url)}}},[t._v(t._s(e.CustomName))]),t._v(" "),i("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(i){return t.handleRemove(e)}}})],1)]):t._e()}),0),t._v(" "),1==t.details.waybillinfo.WaybillType&&100==t.details.waybillinfo.ExcuteStatus&&"正在提货"!=t.TakeGoodsName?i("li",{staticStyle:{position:"absolute",top:"147px",right:"0"}},[i("Button",{attrs:{type:"primary"},on:{click:t.TakeGoods}},[t._v(t._s(t.TakeGoodsName))])],1):t._e()])])],1):t._e()],1)]),t._v(" "),i("div",{staticClass:"itembox"},[i("p",{staticClass:"detailtitle"},[t._v("产品清单")]),t._v(" "),i("div",{staticStyle:{margin:"15px 0"}},[i("ButtonGroup",{staticStyle:{width:"28%"}},[i("Input",{staticStyle:{width:"80%",float:"left",position:"relative",left:"3px"},attrs:{placeholder:"请输入品牌或型号"},model:{value:t.searchkey,callback:function(e){t.searchkey=e},expression:"searchkey"}}),t._v(" "),i("Button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:t.search_filter}},[t._v("筛选")])],1),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.detailelist}},[t._v("清单打印")]),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.Labelprint}},[t._v("标签打印")]),t._v(" "),i("Button",{attrs:{type:"primary",disabled:120==t.details.waybillinfo.ExcuteStatus},on:{click:t.SetStorehouse}},[t._v("一键入库")]),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.showBudget}},[t._v("收支明细")]),t._v(" "),i("div",{staticStyle:{float:"right"}},[i("Button",{attrs:{disabled:120==t.details.waybillinfo.ExcuteStatus,type:"primary",shape:"circle",icon:"md-checkmark"},on:{click:t.finish_btn}},[t._v("入库完成")]),t._v(" "),i("Button",{attrs:{disabled:120==t.details.waybillinfo.ExcuteStatus,type:"warning",shape:"circle",icon:"ios-alert-outline"},on:{click:t.isAbnormalclick}},[t._v("到货异常")])],1)],1),t._v(" "),i("div",[i("div",{staticClass:"detail_tablebox"},[i("Table",{ref:"selection",attrs:{loading:t.loading,columns:t.details.columns1,data:t.details.detailitem,"row-class-name":t.rowClassName},on:{"on-selection-change":t.handleSelectRow},scopedSlots:t._u([{key:"indexs",fn:function(e){e.row;var i=e.index;return[t._v(t._s(i+1))]}},{key:"Arrival",fn:function(e){var a=e.row;return e.index,[1==a.Enabled&&0!=a.iscx?i("span",[t._v(t._s(a.SortedQuantity)+" / "+t._s(a.Quantity))]):t._e()]}},{key:"OriginDes",fn:function(e){var a=e.row,l=e.index;return[i("span",[t._v(t._s(a.Input.OriginDescription))]),t._v(" "),i("Icon",{staticClass:"sethover",attrs:{type:"md-create"},on:{click:function(e){return t.clickClient(a.Input.Origin,a,l)}}})]}},{key:"ShelveID",fn:function(e){var a=e.row,l=e.index;return[1==a.Enabled?i("Select",{attrs:{filterable:"",transfer:!0,"label-in-value":!0},on:{"on-change":function(e){return t.changConveyingplace(e,a,l)}},model:{value:a.ShelveID,callback:function(e){t.$set(a,"ShelveID",e)},expression:"row.ShelveID"}},t._l(t.Storehouselist,function(e,a){return i("Option",{key:e.ID,attrs:{value:e.ID}},[t._v(t._s(e.ID))])}),1):i("Select",{attrs:{disabled:!0,filterable:"",transfer:!0,"label-in-value":!0},on:{"on-change":function(e){return t.changConveyingplace(e,a,l)}},model:{value:a.ShelveID,callback:function(e){t.$set(a,"ShelveID",e)},expression:"row.ShelveID"}},t._l(t.Storehouselist,function(e,a){return i("Option",{key:e.ID,attrs:{value:e.ID}},[t._v(t._s(e.ID))])}),1)]}},{key:"imglist",fn:function(e){var a=e.row;return e.index,t._l(a.Files,function(e,l){return 8e3==e.Type?i("p",{staticClass:"setimgcolor"},[i("span",{on:{click:function(i){return t.PictureShow(e.Url)}}},[t._v(t._s(e.CustomName))]),t._v(" "),i("Icon",{ref:a.ID,refInFor:!0,attrs:{type:"ios-trash-outline"},nativeOn:{click:function(e){return t.handleRemovelist(a,l)}}})],1):t._e()})}},{key:"operation",fn:function(e){var a=e.row,l=e.index;return[i("div",{staticClass:"setupload"},[i("Button",{attrs:{disabled:120==t.details.waybillinfo.ExcuteStatus,type:"primary",size:"small",icon:"ios-cloud-upload"},on:{click:function(e){return t.SeletUpload(a.InputID)}}},[t._v("传照")])],1),t._v(" "),i("div",{staticClass:"setupload"},[i("Button",{attrs:{disabled:120==t.details.waybillinfo.ExcuteStatus,type:"primary",icon:"md-reverse-camera"},on:{click:function(e){return t.fromphotos(a.InputID)}}},[t._v("拍照")])],1),t._v(" "),0!=a.iscx?i("div",{staticClass:"setupload"},[i("Button",{attrs:{disabled:120==t.details.waybillinfo.ExcuteStatus,type:"primary",icon:"md-checkmark"},on:{click:function(e){return t.chaixiang(l,a)}}},[t._v("拆项")])],1):t._e(),t._v(" "),0==a.iscx?i("div",{staticClass:"setupload"},[i("Button",{attrs:{disabled:120==t.details.waybillinfo.ExcuteStatus,type:"primary",icon:"ios-trash-outline"},on:{click:function(e){return t.removechaixiang(l,a)}}},[t._v("删除")])],1):t._e()]}}])}),t._v(" "),i("div",{staticStyle:{padding:"10px"}}),t._v(" "),i("div",{staticClass:"successbtn"},[i("Button",{attrs:{type:"primary",icon:"md-checkmark",disabled:120==t.details.waybillinfo.ExcuteStatus},on:{click:t.finish_btn}},[t._v("入库完成")]),t._v(" "),i("Button",{attrs:{type:"warning",icon:"ios-alert-outline",disabled:120==t.details.waybillinfo.ExcuteStatus},on:{click:t.isAbnormalclick}},[t._v("到货异常")])],1)],1)])]),t._v(" "),1==t.WarehousingMsg?i("div",[i("Modal",{attrs:{title:"确定入库"},on:{"on-ok":t.ok_Warehousing,"on-cancel":t.cancel_Warehousing},model:{value:t.WarehousingMsg,callback:function(e){t.WarehousingMsg=e},expression:"WarehousingMsg"}},[0!=t.Nomatching.length?i("div",[i("h2",[t._v("以下型号数量与通知应到数量不符，是否继续进行入库操作")]),t._v(" "),i("ul",t._l(t.Nomatching,function(e,a){return i("li",{key:a},[i("h2",[t._v(t._s(e))])])}),0)]):i("div",[i("span",[t._v("是否全部入库")])])])],1):t._e(),t._v(" "),i("Modal",{attrs:{title:"一键入库"},on:{"on-cancel":t.cancel},model:{value:t.sethousbox,callback:function(e){t.sethousbox=e},expression:"sethousbox"}},[i("div",{attrs:{slot:"close"},slot:"close"},[i("Icon",{staticStyle:{"font-size":"18px"},attrs:{type:"md-close-circle",color:"rgb(33, 28, 28)"},on:{click:t.closeerror}})],1),t._v(" "),i("span",{staticStyle:{"line-height":"26px"}},[t._v("选择库位")]),t._v(" "),t.Storehouselist.length>0?i("Select",{attrs:{filterable:""},model:{value:t.housenumber,callback:function(e){t.housenumber=e},expression:"housenumber"}},t._l(t.Storehouselist,function(e){return i("Option",{key:e.ID,attrs:{value:e.ID}},[t._v(t._s(e.ID))])}),1):t._e(),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{on:{click:t.cancel}},[t._v("取消")]),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.changehouse}},[t._v("确定")])],1)],1),t._v(" "),i("Modal",{attrs:{title:"到货异常"},on:{"on-visible-change":t.changeerror},model:{value:t.isAbnormal,callback:function(e){t.isAbnormal=e},expression:"isAbnormal"}},[i("div",{attrs:{slot:"close"},slot:"close"},[i("Icon",{staticStyle:{"font-size":"18px"},attrs:{type:"md-close",color:"rgb(33, 28, 28)"},on:{click:t.closeerror}})],1),t._v(" "),i("span",{staticStyle:{"line-height":"26px"}},[t._v("异常原因")]),t._v(" "),i("Input",{attrs:{type:"textarea",rows:2,placeholder:"备注"},model:{value:t.Summary.Summary,callback:function(e){t.$set(t.Summary,"Summary",e)},expression:"Summary.Summary"}}),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{on:{click:t.closeerror}},[t._v("取消")]),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:t.Abnormal_btn}},[t._v("确定")])],1)],1)],1),t._v(" "),i("Drawer",{attrs:{closable:!0,width:70,"mask-closable":!0},model:{value:t.historydata,callback:function(e){t.historydata=e},expression:"historydata"}},[i("Historys-dom",{key:t.historydetail.times,ref:"Historygoods"})],1),t._v(" "),i("Modal",{attrs:{width:"55%",closable:!1,"mask-closable":!1,"footer-hide":!0},model:{value:t.Budgetdetail,callback:function(e){t.Budgetdetail=e},expression:"Budgetdetail"}},[i("div",{staticStyle:{clear:"both",overflow:"hidden","font-size":"16px","padding-bottom":"10px"}},[i("Icon",{staticStyle:{float:"right","font-size":"30px","font-weight":"bold"},attrs:{type:"ios-close"},on:{click:t.closeBudget}})],1),t._v(" "),i("div",[i("router-view")],1)]),t._v(" "),i("Modal",{attrs:{title:"选地地区"},on:{"on-cancel":t.cancel},model:{value:t.setClientCode,callback:function(e){t.setClientCode=e},expression:"setClientCode"}},[i("Select",{attrs:{filterable:"","label-in-value":!0},on:{"on-change":t.changClientCode},model:{value:t.ClientCode,callback:function(e){t.ClientCode=e},expression:"ClientCode"}},t._l(t.Conveyingplace2,function(e,a){return i("Option",{key:e.ID,attrs:{value:e.CorPlace}},[t._v(t._s(e.Text))])}),1),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:t.primaryClientCode}},[t._v("确定")])],1)],1)],1)},staticRenderFns:[]};var o=function(t){i("egD0")},s=i("VU/8")(a.a,l,!1,o,null,null);e.default=s.exports}});
//# sourceMappingURL=22.c9ac5dcec487dd988c0f.js.map